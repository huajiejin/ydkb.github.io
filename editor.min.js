function update_indicator(e,a){if(e<8){indicator[e]=a,keymaps[2][0][0]=indicator[0]|indicator[1]<<8,keymaps[3][0][0]=indicator[2]|indicator[3]<<8,keymaps[4][0][0]=indicator[4]|indicator[5]<<8,keymaps[5][0][0]=indicator[6]|indicator[7]<<8;a=$(`#indicator_dropdown_menu li[value=${indicator[e]}]`),a=(a&&$("#indicator_dropdown-btn_"+e).text(a.text()).attr({"data-tooltip":a.attr("data-tooltip"),value:indicator[e]}),$("#indicator_dropdown-name_"+e).text()+" : "+$("#indicator_dropdown-btn_"+e).text());$("#keyboard-outline").find(".kbd-led.led"+e).attr("data-tooltip",a)}else{for(var t=new Array,s=0;s<4;s++){var o=keymaps[s+2][0][0];t[2*s]=255&o,t[2*s+1]=o>>8}for(s=0;s<8;s++)update_indicator(s,t[s])}7==e&&console.log(keymaps[2][0][0].toString(16),keymaps[3][0][0].toString(16),keymaps[4][0][0].toString(16),keymaps[5][0][0].toString(16))}function update_indicator_color(e,a){var t,s,o;if(console.log("Set LED"+e+": #"+a),e<8)"block"==$("#indicator-color-btn_"+e).css("display")&&(indicator_color[e]=a,t=parseInt(a.substr(0,2),16),s=parseInt(a.substr(2,2),16),o=parseInt(a.substr(4,2),16),keymaps[e][0][1]=t|s<<8,keymaps[e][0][2]=o,$("#indicator-color-btn_"+e)[0].jscolor.fromString(a),$("#indicator-color-btn_"+e).attr("value",a),$("#mykbd").find(".kbd-led.led"+e).each(function(){$(this).css("background-color","#"+a);var e=M.Tooltip.getInstance(this);e&&$(e.tooltipEl).find(".aug")[0].style.setProperty("--aug-border-bg","#"+a)}),$("#keyboard-ledmap").find("#indicator_dropdown-btn_"+e).each(function(){var e=M.Tooltip.getInstance(this);e&&$(e.tooltipEl).find(".aug")[0].style.setProperty("--aug-border-bg","#"+a)}));else for(var n=0;n<8;n++)update_indicator_color(n,("000000"+((255&keymaps[n][0][1])<<16|65280&keymaps[n][0][1]|255&keymaps[n][0][2]).toString(16)).substr(-6))}function update_keycap_color(a){$.cookie?null==a&&$.cookie("ck_keycap_color")?a=$.cookie("ck_keycap_color").match(/#(.{6})/g):a&&6==a.length&&$.cookie("ck_keycap_color",a,{expires:365,path:"/"}):null==a&&now_keycap_color&&(a=now_keycap_color),6==(a=null==a?["#575d5e","#e3d9c6","#ed6b21","#575d5e","#575d5e","#ed6b21"]:a).length&&(document.documentElement.style.setProperty("--color-mykeycap1",a[0]),document.documentElement.style.setProperty("--bgcolor-mykeycap1",a[1]),document.documentElement.style.setProperty("--color-mykeycap2",a[2]),document.documentElement.style.setProperty("--bgcolor-mykeycap2",a[3]),document.documentElement.style.setProperty("--color-mykeycap3",a[4]),document.documentElement.style.setProperty("--bgcolor-mykeycap3",a[5]),now_keycap_color=a,$("#keycap_color-user").find('[onchange^="update_keycap_color_single("]').each(function(){var e=$(this).attr("onchange").slice(27,28),e=a[e].slice(1,7);console.log(e),$(this)[0].jscolor.fromString(e),$(this).attr("value",e)}),$(".border .top").css("background-color","transparent"),$(".border .top").css("background-color",""))}function update_keycap_color_single(e,a){console.log("set color "+e+" to "+a),console.log(now_keycap_color),now_keycap_color[e]="#"+a,update_keycap_color(now_keycap_color),$("#user-keycap-colors").val(now_keycap_color)}function update_case_color(e){e&&6==e.length&&(e="#"+e),$.cookie?null==e?e=$.cookie("ck_case_color"):$.cookie("ck_case_color",e,{expires:365,path:"/"}):now_case_color&&(e=now_case_color),e&&($("#case_color_css").remove(),$('<style id="case_color_css" type="text/css">.mycase{background-color: {0}!important}</style>'.format(e)).appendTo("head"),now_case_color=e)}function update_plate_color_user(e){6==e.length&&(e="#"+e,$("#plate_color_css").remove(),$('<style id="plate_color_css" type="text/css">.plate{background-color: {0}!important}</style>'.format(e)).appendTo("head"),now_case_color=e)}function jsdef_init(){$(".jsdef").each(function(){var e=$(this).attr("class"),a=e.match(/(.*?)ml-(\d+)(.*?)/),t=e.match(/(.*?)pl-(\d+)(.*?)/),s=e.match(/(.*?)ht-(\d+)(.*?)/),o=e.match(/(.*?)wd-(\d+)(.*?)/),e=e.match(/(.*?)lh-(\d+)(.*?)/);a&&$(this).css({"margin-left":a[2]+"px"}),t&&$(this).css({"padding-left":t[2]+"px"}),s&&$(this).css({height:s[2]+"px"}),o&&$(this).css({width:o[2]+"px"}),e&&$(this).css({"line-height":e[2]+"px"})})}function onLangChange(e){language=e,window.lang.change(e);var a=".lang-en",t=".lang-zh_sc";"zh_cn"==e&&([a,t]=[t,a]),$(a).show(),$(t).hide(),"zh_cn"!=e&&fetch("lang/en.json").then(function(e){if(e.ok)return e.json()}).then(function(a){$("#keyboard-outline").find(".kbd-led").each(function(){var e=$(this).attr("class").match(/.*led(\d)/);e&&7<e[1]&&((e=a.token[$(this).attr("data-tooltip")])&&$(this).attr("data-tooltip",e))}),$("#fn-set").find("a").each(function(){var e;!this.id.match(/_dropdown-btn/)||(e=a.token[$(this).attr("data-tooltip")])&&$(this).attr("data-tooltip",e)})}),setTimeout(function(){tooltip_init(),update_logo_desc(),$("#key-set-tabs").tabs("updateTabIndicator")},500)}function LangChange(e){language!=e&&($("#layer_set").tabs("select","layer_0"),onLangChange(e))}function tooltip_init(){$(".tooltipped").tooltip({delay:50}),update_indicator_color(10)}function update_logo_desc(){var e=$("#firmware-dropdown-btn").attr("value"),e=$("#firmware-dropdown").find("[value="+e+"]").attr("data-tooltip");$("#logo_desc").text(e)}function display_label(e,a){var t,s=new Action(e),o=new Action(255&e),n={name:s.name,desc:s.desc};if(49151<e&&e<65536&&(0<(t=$("#code-0x"+e.toString(16))).length?(n.name=t.html(),n.desc=t.attr("title")):62464==(62718&e)?((n=display_label(64511&e,a)).name+="<sub>F4</sub>",n.desc+=", 如果和<kt>左Alt</kt>一起时则执行<kt>Alt+F4</kt>"):console4jslang&&(n.name="u"+e.toString(16))),18176<=e&&e<18432&&(t=("0"+(t=(255&e).toString(16))).substr(-2),n.name="SC"+t,n.desc="Launch shortcut "+t),n.name.match(/.*?BS.*?/)&&$(`.key.k${a}:visible`).each(function(){86.4<$(this).parents(".border")[0].offsetWidth&&(n.name=n.name.replace("BS","Backspace"))}),$("#keycap_style_gmk.nowdsa")[0]&&(o.name_dsa?n.name=" "+s.name_dsa:n.name="<i"==n.name.substr(0,2)?n.name:n.name.toUpperCase()),is_mac&&!$("#keycap_style_gmk.nowdsa")[0]){if(n.name.match(/.*?Ctrl.*?/)&&$(`.key.k${a}:visible`).each(function(){$(this).parents(".border")[0].offsetWidth<=54&&(n.name=n.name.replace("Ctrl","short_ctl"))}),n.name.match("kb kb-"))return n;n=keylabel_mac(n),kc_alpha(e)||kc_numpad(e)?n.name=` <i class="bigfont"><div style="height:15px"></div><I>${n.name.replace(/<br>.*/g,"")}</I></i>`:kc_symbol(e)||kc_function(e)||70<=e&&e<=72?n.name=` <i class="midfont">${e<57?"":'<div style="height:15px"></div>'}<I>${n.name}<I></i>`:n.name=` ${n.name.match(/.*( |<br>).*/)?"":"<br>"}<I>${n.name.toLowerCase()}<I></i>`}else(kc_alpha(e)||kc_numpad(e))&&(n.name=` <i class="bigfont">${n.name}</i>`),(kc_symbol(e)||kc_function(e))&&(n.name=` <i class="midfont">${n.name}</i>`);return"en"==language&&(n.desc=window.lang.translate(n.desc,"en")),$(`.key.k${a}:visible`).each(function(){$(this).closest(".border").parent().hasClass("round")&&(n.name=n.name.replace(/<br>/g," "))}),n}function kbd_name_filter(e){var a=e.toLowerCase();$("#firmware-dropdown").find("li:not(.optgroup)").each(function(e){$(this).css("display",($(this).text()+$(this).attr("data-tooltip")).toLowerCase().includes(a)?"block":"none")})}function user_keycap_colors(e){console.log(e)}function gernerate_kbd_list(e,a,t){return`<li value="${e}" class="tooltipped tip_kbdlist" data-position="right" deta-delay="80" data-tooltip="${a}" lang="zh_sc"> <a lang="zh_sc">${t}<i class="material-icons fav-kbd" lang="zh_sc" title="加入或取消收藏">favorite_border</i>`}function fav_kbd_list_refresh(){$.cookie&&($("#fav-kbd-list").find(".tooltipped").each(function(){var e=M.Tooltip.getInstance(this);e&&e.destroy(),$(this).remove()}),$("#firmware-dropdown").find(".myfav").each(function(){var e=$(this).parent().parent().attr("value");$("#fav-kbd-list").append(gernerate_kbd_list(e,CONFIG.kbd[e].desc,CONFIG.kbd[e].name)),$("#fav-kbd-list").find(`[value=${e}]`).each(function(){$(this).find(".fav-kbd").addClass("myfav").text("favorite"),M.Tooltip.getInstance(this)||M.Tooltip.init(this)})}))}function process_html_page(){for(var e in update_copyright(),$("#fn-set").find("a").each(function(){var e;this.id.match(/_dropdown-btn/)&&(e=this.id.replace("-btn",""),$(this).addClass("col dropdown-trigger btn-flat select tooltipped uicolor").attr({"data-target":e,"data-tooltip":$(this).text()}),$(this).next("ul").addClass("dropdown-content"))}),$(".waves-effect").addClass("waves-light"),CONFIG.kbd)e.match(/optgroup.*/)?$("#firmware-dropdown").append('<li class="disabled optgroup uicolor-text"><span>'+CONFIG.kbd[e].name):e.match(/.*hidden/)||$("#firmware-dropdown").append(gernerate_kbd_list(e,CONFIG.kbd[e].desc,CONFIG.kbd[e].name));var a;if($.cookie&&$.cookie("fav_list"))for(a of $.cookie("fav_list").split(" "))a&&$("#firmware-dropdown").find(`[value=${a}]`).find(".fav-kbd").addClass("myfav").text("favorite");fav_kbd_list_refresh();for(let e=0;e<8;e++)$("#ledmap-setting").append(`<div>                 <a id="indicator_dropdown-name_${e}" class="col mykeycap2" lang="zh_sc">LED${e}:</a>                 <a id="indicator_dropdown-btn_${e}" class='col dropdown-trigger btn select uicolor' data-target='indicator_dropdown_menu'>选择功能</a>                 <input id="indicator-color-btn_${e}" class="col btn jscolor" type="show"  onchange="update_indicator_color(${e},''+this.jscolor)" value="ff0000"> </div>`);for(let e=1;e<5;e++)e<4?$("#keycap_color-user-setting").append(`<div><a class="col mykeycap${e} key-flat" title="Keycaps1" lang="zh_sc">Main</a></div>                     <div><a lang="zh_sc">文字颜色</a><input class="col btn jscolor" type="show"  onchange="update_keycap_color_single(${2*(e-1)},''+this.jscolor)" value="ffffff"></div>                     <div><a lang="zh_sc">键帽颜色</a><input class="col btn jscolor" type="show"  onchange="update_keycap_color_single(${2*(e-1)+1},''+this.jscolor)" value="ffffff"></div>`):$("#keycap_color-user-setting").append(`<div><a class="col mycase key-flat" style="padding: 6px" title="Keycaps3" lang="zh_sc"><span class="plate" style="width: calc(100% - 6px);height: calc(100% - 6px);"></span></a></div>                     <div><a lang="zh_sc" class="tooltipped" data-tooltip="建设中，切换键帽样式可以恢复到默认颜色">外壳颜色(dev)</a> <input class="col btn jscolor" type="show"  onchange="update_case_color(''+this.jscolor)" value="ffffff"> </div>                     <div><a lang="zh_sc" class="tooltipped" data-tooltip="建设中，刷新页面可以恢复到默认颜色">定位板(dev)</a> <input class="col btn jscolor" type="show"  onchange="update_plate_color_user(''+this.jscolor)" value="ffffff"> </div>`);jscolor.installByClassName("jscolor"),$("#setting-pane .keyboard-set").find("li").each(function(e){if(this.id&&-1!=this.id.indexOf("code-")){var a,t=[{attr:"L",class:"low"},{attr:"S",class:"s1"},{attr:"R",class:"rowstart"},{attr:"A",class:"t1a"},{attr:"T",class:"t1"},{attr:"W",class:"name_win"},{attr:"M",class:"name_mac"}];for(a in t)null!=$(this).attr(t[a].attr)&&$(this).addClass(t[a].class).removeAttr(t[a].attr);null==$(this).attr("class")&&-1==$(this).html().indexOf("<br>")&&$(this).addClass("t1"),$(this).addClass("key-set"),-1!=this.id.indexOf("-0x")&&$(this).attr("lang","zh_sc")}}),$("#setting-pane").find(".keys-category").attr("lang","zh_sc"),$("#indicator_dropdown_menu").find("li").attr("lang","zh_sc").addClass("tooltipped").attr("data-position","right").find("a").attr("lang","zh_sc"),$("#fn-set").find("a").attr("lang","zh_sc"),$("#keyboard-ledmap").find(".dropdown-trigger").addClass("tooltipped").attr("data-position","right"),$("#keyboard-ledmap").find('[id^="indicator_dropdown-name_"]').addClass("tooltipped").attr("data-position","left");for(let e=1;e<16;e*=2)$("#key_mods_dropdown,#layer_mods_dropdown").append(`<li class="optgroup-option"><span><label><input type="checkbox" value="${e}"><span>${mods_codes[e].name}</span></label></span></li>`);let t=new Lang;t.init({defaultLang:"zh_sc"}),$(".key-set_shift_off, .key-set_shift_on").find("li").each(function(e){var a=$(this).html().match(/(.*)\<br\>(.*)/);a&&$(this).html(`<span class="t2_s">${a[1]}</span><br><span class="t2_l">${a[2]}</span>`)})}function first_visit(){var e;$.cookie&&!$.cookie("ck_select_kbd")&&(e=document.querySelector("#nav-side"),M.Sidenav.getInstance(e).open())}function kc_alpha(e){return 3<e&&e<30}function kc_symbol(e){return 29<e&&e<40||44<e&&e<57||100==e}function kc_function(e){return 57<e&&e<70||103<e&&e<116}function kc_numpad(e){return 83<e&&e<100&&88!=e||176==e}CONFIG={kbd:{optgroup0:{name:"YDKB ( High-end )"},yd1800mini:{name:"1800mini",desc:"1800mini 双模RGB热插拔键盘 by YANG",firmware_url:"./config/1800mini.hex",layout:"./config/layout-1800mini.html",size:{AutoCase:1,X:16,Y:5.25,M:-24,BR:16},checksum:{value:6145,addr:65280}},ben30_hidden:{name:"BEN30",desc:"BEN30 双模RGB热插拔键盘(玩具) by YANG & Xikii",firmware_url:"./config/chicory.hex",layout:"./config/layout-ben30.html"},ben40_hidden:{name:"BEN40",desc:"BEN40 双模RGB热插拔键盘 by YANG & Xikii",firmware_url:"./config/chicory.hex",layout:"./config/layout-ben40.html"},master98:{name:"Master98 Pro",desc:"Master98 Pro 双模RGB热插拔键盘 by YANG & Xikii",size:{AutoCase:1,X:19.5,Y:6.5,MU:-18,MR:-18,MD:-12,ML:-18},checksum:{value:6552,addr:65280}},sairo64:{name:"Sairo64",desc:"Sairo64(赛罗64) 60%双模RGB热插拔PCB by YANG",size:{AutoCase:1,X:15,Y:5,MU:-24}},taichi:{name:"TAICHI PAD",desc:"黑白双色PCB，8颗RGB底灯组成太极八卦图，16个按键，独立灯控的RGB轴灯实现千万种颜色",size:{AutoCase:1,X:4,Y:4,M:-24,BR:16}},x8086k:{name:"X-8086K",desc:"X-8086K(80%尺寸86键) 双模RGB热插拔键盘",firmware_url:"./config/X-8086K.hex",size:{AutoCase:1,X:18.25,Y:6.25,M:-24,BR:16}},optgroup1:{name:"YDKB (BLE系列键盘)"},aria:{name:"Aria",desc:"Layout test. 8deg rotation (not 12deg as Alice). Maybe not the final version.",firmware_url:"./config/louise.hex",size:{MaskHeight:375},checksum:{value:8513,addr:26368}},ble40:{name:"BLE40",desc:"USB/BLE双模40% RGB无线键盘 by YANG",firmware_url:"./config/ble40_blup.hex",size:{AutoCase:1,X:12,Y:4}},blup:{name:"BLUP",desc:"USB/BLE双模40% RGB无线键盘 by YANG",firmware_url:"./config/ble40_blup.hex",size:{AutoCase:1,X:12,Y:4}},cad66:{name:"CAD66",desc:"CAD66 USB/BLE双模PCB，此固件不适合CA66原配单模PCB",size:{AutoCase:1,X:16.5,Y:5.25,MU:-24,MR:-16,MD:-16,ML:-16}},d60ble:{name:"D60BLE",desc:"60% USB/BLE Hotswap PCB by YANG for D60 from KBDFans",size:{AutoCase:1,X:15,Y:5,M:-18,BR:9},checksum:{value:8545,addr:26368}},duang60:{name:"Duang60",desc:"专为无钢或半钢设计的60%蓝牙双模PCB by YANG，单模版也使用此固件。",size:{AutoCase:1,X:15,Y:5,MU:-24},checksum:{value:8288,addr:26368}},duang60_v2:{name:"Duang60 v2",desc:"Duang60的热插拔版本，适配某些特定键盘如： Falcon / Rama Kara / S58m等",firmware_url:"./config/duang60_v2.hex",size:{AutoCase:1,X:15,Y:5,MU:-24},checksum:{value:8546,addr:26368}},chicory:{name:"Chicory",desc:"Chicory 40%双模键盘",size:{AutoCase:1,X:12,Y:4}},fmini:{name:"Fmini",desc:"一个类似Kmini布局的PCB by YANG",size:{AutoCase:1,X:18.5,Y:5,MU:-32,MR:-16,MD:-16,ML:-16,BR:6}},hello_v1:{name:"Hello_v1",desc:"Hello Keyborad v1，支持多个键盘，包括HHKB改装，MX轴，ALPS轴等",size:{AutoCase:1,X:15,Y:5,MU:-24,MR:-18,MD:-18,ML:-18},checksum:{value:8556,addr:26368}},just60:{name:"Just60",desc:"60%蓝牙双模机械键盘 by YANG",firmware_url:"./config/just60_yd60ble.hex",size:{AutoCase:1,X:15,Y:5,MU:-24}},just66:{name:"Just66",desc:"USB/BLE 双模多配列PCB，仅v1.x支持CA66外壳。珈蓝PCJR的双模默认是此PCB。",firmware_url:"./config/just68.hex",size:{AutoCase:1,X:16.5,Y:5.25,MU:-24,MR:-16,MD:-16,ML:-16},checksum:{value:6502,addr:26368}},just660:{name:"Just660",desc:"USB/BLE 双模多配列PCB for Leopold FC660M",firmware_url:"./config/just68.hex",size:{AutoCase:1,X:16.5,Y:5,M:-18,BR:6}},just68:{name:"Just68",desc:"USB/BLE 双模多配列键盘（兼容Tada68外壳和小门牙）",size:{AutoCase:1,X:16,Y:5}},just68v2:{name:"Just68 v2",desc:"USB/BLE 双模热插拔键盘，仅支持单空格和单配列，自带一个旋钮编码器",size:{AutoCase:1,X:16,Y:5},checksum:{value:8552,addr:26368}},louise:{name:"Louise",desc:"40% version of Alice",firmware_url:"./config/louise.hex",size:{MaskHeight:320},checksum:{value:8513,addr:26368}},minira:{name:"Minira",desc:"60%蓝牙双模机械键盘 配列同Filco Minila",size:{AutoCase:1,X:15,Y:5,MU:-24}},minira_v2:{name:"Minira v2",desc:"支持双旋钮，60%蓝牙双模机械键盘，支持Minira配列和64配列，单模版也使用此固件。",size:{AutoCase:1,X:15,Y:5,MU:-24},firmware_url:"./config/minira_v2.hex",checksum:{value:8544,addr:26368}},pearly:{name:"Pearly",desc:"40%蓝牙双模机械键盘PCB, 兼容Pearl",firmware_url:"./config/pearly.hex",size:{AutoCase:1,X:13,Y:4,M:-24},checksum:{value:8256,addr:26368}},xikii104:{name:"Xikii i104",desc:"大爽全尺寸键盘",size:{AutoCase:1,X:23,Y:7,EY:-1.4,MU:-70,MR:-40,MD:-54,ML:-40,BR:18},checksum:{value:8608,addr:26368}},xikii_6x:{name:"Xikii i6x",desc:"小爽键盘",size:{AutoCase:1,X:16.5,Y:5,MU:-70,MR:-32,MD:-32,ML:-32,BR:12},checksum:{value:8550,addr:26368}},xikii_8x:{name:"Xikii i8x",desc:"中爽键盘",size:{AutoCase:1,X:18.5,Y:7,EY:-.5,MU:-70,MR:-40,MD:-54,ML:-40,BR:18},checksum:{value:8576,addr:26368}},yd43sw_hidden:{name:"YD43sw",desc:"YD43sw 还没有做的，计划中",firmware_url:"./config/yd40w.hex",layout:"./config/layout-yd43sw.html"},yd60ble:{name:"YD60BLE",desc:"60%蓝牙双模机械键盘 by YANG",firmware_url:"./config/just60_yd60ble.hex",size:{AutoCase:1,X:15,Y:5,MU:-24}},yd67ble_v1:{name:"YD67BLE v1.0",desc:"for YD67BLE v1.0 only.",size:{AutoCase:1,X:16,Y:5,M:-18,BR:9},layout:"./config/layout-yd67ble.html",checksum:{value:8551,addr:26368}},yd67ble:{name:"YD67BLE",desc:"65% USB/BLE Hotswap PCB by YANG for KBD67 from KBDFans",size:{AutoCase:1,X:16,Y:5,M:-18,BR:9},checksum:{value:8551,addr:26368}},yd81_hidden:{name:"YD81",desc:"Get more than 80%. 支持有线蓝牙双模",firmware_url:"./config/yd81.hex",layout:"./config/layout-yd81.html"},ydp50:{name:"YDP50",desc:"USB/BLE双模50% 无线键盘 by YANG",size:{AutoCase:1,X:12,Y:5}},ydpm40ble:{name:"YDPM40BLE",desc:"YDPM40 双模版",size:{AutoCase:1,X:12,Y:4}},optgroup2:{name:"YDKB (其他键盘)"},akb48:{name:"AKB48",desc:"Atreus Keyboard 48 by YANG",size:{MaskHeight:320}},cod67:{name:"COD67",desc:"COD67 PCB by YANG",size:{MaskHeight:370}},ergoplus_hidden:{name:"ErgoPlus",desc:"An ErgoDox layout keyboard with full RGB and hotswap",firmware_url:"./config/ergodone.hex",layout:"./config/layout-ergoplus.html"},eswn:{name:"ESWN",desc:"ESWN四键RGB小键盘"},gamer87_hidden:{name:"Gamer87",desc:"功能等针对游戏玩家优化设计的87键键盘，Gamer系列的第一款产品",firmware_url:"./config/gamer87.hex",layout:"./config/layout-gamer87.html"},hskb:{name:"HSKB",desc:"HSKB原型机一，分体有线带屏幕键盘",size:{AutoCase:1,X:16,Y:5,MU:-78,MR:-18,MD:-18,ML:-18}},mountain:{name:"Mountain",desc:"for KBDFans Mountain v1 and Mountain v2",size:{MaskHeight:380},checksum:{value:8547,addr:26368}},ns60:{name:"NS60",desc:"60%蓝牙双模机械键盘，同时支持上下灯位",size:{AutoCase:1,X:15,Y:5,MU:-24}},sasuke01:{name:"Sasuke No.01",desc:"佐助(辅佐助手)小键盘测试用",size:{MaskHeight:210},checksum:{value:8464,addr:26368}},simpo40:{name:"Simpo40",desc:"40% Keyboard.",firmware_url:"./config/simpo_uf2.hex",size:{AutoCase:1,X:12,Y:4}},simpo66:{name:"Simpo66",desc:"单模有线版PCB，支持CA66旧版外壳。珈蓝PCJR的单模默认是此PCB",firmware_url:"./config/simpo_uf2.hex",size:{AutoCase:1,X:16.5,Y:5.25,MU:-24,MR:-16,MD:-16,ML:-16}},simpo68:{name:"Simpo68",desc:"65% Keyboard. Just68的单模有线版本",firmware_url:"./config/simpo_uf2.hex",size:{AutoCase:1,X:16,Y:5}},stm60:{name:"STM60",desc:"60% Keyboard that uses STM32F103",size:{AutoCase:1,X:15,Y:5,MU:-24}},stm60c:{name:"STM60.C",desc:"60% Keyboard that uses STM32F103",firmware_url:"./config/stm60.hex",size:{AutoCase:1,X:15,Y:5,MU:-24}},thx30:{name:"THX30",desc:"THX30 30% RGB小键盘，支持BLE模块，非卖品",size:{AutoCase:1,X:10,Y:3}},uukb:{name:"UUKB",desc:"USB/优联 双模键盘",firmware_url:"./config/uukb_uf2.hex"},yd68:{name:"YD68",desc:"YD68双空格键盘，v2为单空格但支持蓝牙双模",size:{AutoCase:1,X:16,Y:5}},ydkb_u2u:{name:"YDKB优联",desc:"YDKB的优联键盘集合",size:{MaskHeight:310}},ydp60:{name:"YDP60",desc:"YDP60",size:{AutoCase:1,X:15,Y:5,MU:-24}},ydpm40:{name:"YDPM40",desc:"YDP40 双空格类Planck and YDM40 by YANG",size:{AutoCase:1,X:12,Y:4}},yxpad:{name:"YXPAD",desc:"Y(有)X(线)Pad，全灯RGB",size:{AutoCase:1,X:4,Y:6}},optgroup3:{name:"YDKB Mod"},apple_adb:{name:"Apple_ADB",desc:"Apple ADB Keyboard to USB",size:{MaskHeight:416}},ble660c:{name:"BLE660C",desc:"USB/BLE Controller for Leopold FC660C",firmware_url:"./config/ble660c_980c.hex",size:{AutoCase:1,X:16.5,Y:5,M:-18,BR:6},checksum:{value:6502,addr:26368}},ble980c:{name:"BLE980C",desc:"USB/BLE Controller for Leopold FC980C",firmware_url:"./config/ble660c_980c.hex",size:{AutoCase:1,X:19.5,Y:6.75,BR:6},checksum:{value:6502,addr:26368}},ble980m:{name:"BLE980M",desc:"Leopold FC980M USB/蓝牙4.0双模改装",size:{MaskHeight:451}},filco104:{name:"FILCO104",desc:"FILCO104 YDKB Conroller",size:{MaskHeight:416}},hhkb_ble:{name:"HHKB BLE",desc:"USB/BLE Controller for HHKB Professional / Professional 2 / Professional JP",size:{AutoCase:1,X:15,Y:5,MU:-24},checksum:{value:6499,addr:26368}},hhkb_ble_s:{name:"HHKB BLE S",desc:"USB/BLE Controller for HHKB，这一个是提速了按键响应速度的固件，如有兼容问题请使用非S的",layout:"./config/layout-hhkb_ble_s.html",size:{AutoCase:1,X:15,Y:5,MU:-24},checksum:{value:6499,addr:26368}},yd_ap2u_hidden:{name:"YD-AP2U",desc:"AT和PS/2接口转USB转换器，以下是支持的一些布局",firmware_url:"./config/yd3000c.hex",layout:"./config/layout-yd_ap2u.html"},yd3000c:{name:"YD3000c",desc:"G80-3000系列的转换器，支持多种自定义功能，G80-3494支持USB下全键无冲",size:{MaskHeight:540}},optgroup4:{name:"K.T.E.C."},chili:{name:"Chili3000",desc:"K.T.E.C.成员 !#&*^$)~$#`^(%#$Gacathon 作品，G80-3000外壳可用PCB",firmware_url:"./config/lm_chili.hex",layout:"./config/layout-lm_chili.html",size:{AutoCase:1,X:23,Y:7,EY:-1.4,MU:-70,MR:-40,MD:-54,ML:-40,BR:18}},cw40:{name:"CW40",desc:"K.T.E.C.出品，国外设计，国内制造",size:{AutoCase:1,X:12,Y:4}},daisy:{name:"Daisy",desc:"K.T.E.C.出品，国外设计，国内制造",size:{AutoCase:1,X:12,Y:4}},ergodone:{name:"Ergodone",desc:"K.T.E.C.出品，国外设计，国内制造",size:{MaskHeight:460}},grape:{name:"Grape11900",desc:"K.T.E.C.成员 !#&*^$)~$#`^(%#$Gacathon 作品，G80-11900/11800外壳可用PCB",firmware_url:"./config/lm_grape.hex",layout:"./config/layout-lm_grape.html",size:{AutoCase:1,X:20,Y:8,EY:-1.6,MU:-48,MR:-48,MD:-60,ML:-48,BR:18}},leechee:{name:"Leechee1800",desc:"K.T.E.C.成员 !#&*^$)~$#`^(%#$Gacathon 作品，G80-1800外壳可用PCB",firmware_url:"./config/lm_leechee.hex",layout:"./config/layout-lm_leechee.html",size:{AutoCase:1,X:19.5,Y:7,EY:-1.5,MU:-54,MR:-40,MD:-54,ML:-40,BR:18}},staryu:{name:"Staryu",desc:"K.T.E.C.出品，国外设计，国内制造",size:{AutoCase:1,X:3,Y:2}},optgroup5:{name:"Others(第三方)"},ca66:{name:"CA66",desc:"CA66有线版，适用于2020年之前的有线版CA66。2020及之后的，使用若遇软件或硬件问题，自行解决。",size:{MaskHeight:480}},diyer72:{name:"Diyer72",desc:"YDKB's firmware for Diyer72 / Xikii72 Keyboard",size:{MaskHeight:385.5}},exe:{name:"EXE",desc:"E神作品，国内客制化先驱"},gh60:{name:"GH60_ABC",desc:"该固件主要给添加了UART2BT蓝牙模块的使用， 完整支持XD60v2，其他ABC版本自测。",size:{AutoCase:1,X:15,Y:5,MU:-24}},u2u_pro:{name:"U2U PRO",desc:"USB2USB Converter with AT90USB1286",size:{MaskHeight:440}},udock:{name:"UDock",desc:"UDock by Yock and Bobnaive",size:{MaskHeight:514}}}},KEYCAP_COLORS=[{name:"Hana",value:["#a598c5","#efefea"],case_color:"#ebc3f0"},{name:"HHKB",value:["#222222","#eae6e7","#cbcdda"],order:[0,1,0,2,0,2]},{name:"RF 10th",value:["#222222","#989793","#6688aa"],order:[0,1,0,2,0,2],case_color:"#333333"},{name:"Raindrop",value:["#0073a2","#e5e4df"]},{name:"Carbon",value:["#575d5e","#e3d9c6","#ed6b21"],order:[0,1,2,0,0,2],case_color:"#424848"},{name:"Honeywell",value:["#212224","#efefea","#575757","#b01c11"],order:[0,1,1,2,1,3]},{name:"Hyperfuse",value:["#6c3b7b","#c4c4c0","#5dceba","#63696a"],order:[0,1,2,3,2,3]},{name:"Granite",value:["#525554","#e6e8e3","#222222","#a0a4a7"],order:[0,1,2,3,2,3]},{name:"Jukebox",value:["#a51b1b","#d9c9a8","#69d0a5"],order:[0,1,0,2,1,0]},{name:"Valentine",value:["#dc90bc","#efefea"],case_color:"#eaa0ca"},{name:"EVA 01",value:["#93c247","#592254"]},{name:"Pulse",value:["#00a6b4","#212224"]},{name:"Royal Navy",value:["#2f3d6f","#f0f0f0","#a92f0d"],order:[0,1,1,0,1,2]},{name:"Dolch",value:["#e4dedd","#5f5c52","#333430","#00a4a9"],order:[0,1,0,2,0,3]},{name:"Classic Olivetti",value:["#0965ed","#f5f5f5","#cfcdc2"],order:[0,1,0,2,1,0]},{name:"Lime",value:["#93c247","#e5e4df","#7c878e"],order:[0,1,1,2,1,0]},{name:"Eve",value:["#333333","#d4d0c7","#2785db"],order:[0,1,2,0,1,2]},{name:"Godspeed",value:["#666666","#d3cdc1","#6a94b1","#f9eb74"],order:[0,1,1,2,0,3]},{name:"Bentō",value:["#487992","#fff4f0","#f8767e"],order:[0,1,2,0,1,2]},{name:"Jamón",value:["#f2ebd7","#8c303a","#b2343c","#424446"],order:[0,1,0,2,3,0]},{name:"White on Black",value:["#efefea","#222222"],order:[0,1,0,1,0,1]},{name:"βeta",value:["#333333","#dcd6c4","#727473","#dd7632"],order:[0,1,0,2,0,3]},{name:"DMG",value:["#1d1770","#d1cdca","#7f8389","#722158"],order:[0,1,0,2,1,3]},{name:"Shiko",value:["#7a99ac","#dde5ed","#a1d1ee"],order:[0,1,1,0,1,2]},{name:"Olivia++",value:["#222222","#e1dbd1","#373634","#e0b19f"],order:[0,1,3,2,0,3]},{name:"Oblivion",value:["#dedeca","#6b7273","#474946","#297fa9"],order:[0,1,0,2,0,3]},{name:"Oblivion W",value:["#dedeca","#e7e8e5","#474946","#297fa9"],order:[2,1,0,2,0,3]},{name:"Symbiosis",value:["#e5e4df","#747b7b","#0073a2","#ffac00"],order:[0,1,0,2,2,3],case_color:"c4d0d0"},{name:"Posh Blue",value:["#222d5a","#e1dbd1","#d8a0a6"],order:[0,1,2,0,0,2]},{name:"Posh Pink",value:["#222d5a","#e1dbd1","#d8a0a6"],order:[0,1,0,2,2,0]},{name:"Pitta",value:["#333333","#eee6d3","#ccc0a6","#3cdcc6"],order:[0,1,0,2,0,3]}],UI_THEME=[{name:"默认主题",color:"#0288d1"},{name:"红色主题",color:"#e57373"},{name:"粉色主题",color:"#f06292"},{name:"紫色主题",color:"#7e57c2"},{name:"青色主题",color:"#00acc1"},{name:"绿色主题",color:"#4caf50"},{name:"暗黑模式",color:"#242424"}],$(function(){is_mac=navigator.platform.includes("Mac");var r,s,o,n=!0,g=0,f="yd1800mini",d=0,i=255,c="gmk",l=(now_keycap_color=[],iscasejscolor=0,layouts_save="",is_dev=0,is_xikiicom=0),p="",a=transparent_map(),t=(firmware_before_uf2=null,indicator=Array(8).fill(0),indicator_color=Array(8).fill(0),document.location.search.substring(1)),y=t.match(/(.*)-(\d+)/),v=(y?(variant=y[1],layouts_save=y[2]):variant=t,lang=new Lang,Lang.prototype.attrList.push("data-tooltip","data-dropkind"),lang.dynamic("en","lang/en.json"),lang.dynamic("zh_cn","lang/zh_cn.json"),console4jslang=!0,null==window.location.href.match(/18:2|0:8|console/g)?(console.log=()=>{},console4jslang=!1):$("#c-output").show(),-1!=window.location.href.indexOf("dev")&&(is_dev=1,y=$(".brand-logo").html(),$(".brand-logo").html(y.replace("Builder","Builder (DEV)")),$("nav").removeClass("uicolor").addClass("red")),console.log(layouts_save),0),t=url_decode_keymap(document.location.hash.substring(1).replace(/YDKB/g,"+"));function h(e){var a,t,s,o;CONFIG.kbd[e]&&($("#firmware-dropdown-btn").html('<i class="material-icons fl">keyboard</i>'+CONFIG.kbd[e].name).attr({value:e}),$("#logo_name, #kbdinfo_tab_name").text(CONFIG.kbd[e].name),update_logo_desc(),CONFIG.kbd[e].layout||(CONFIG.kbd[e].layout=`./config/layout-${e}.html`),CONFIG.kbd[e].firmware_url||(CONFIG.kbd[e].firmware_url=`./config/${e}.hex`),$("#keyboard-outline").css("display",""),$("#keyboard-ledmap").css("display","none"),$("#firmware-dropdown").find("li.uicolor").removeClass("uicolor"),$("#firmware-dropdown").find(`[value=${e}]`).addClass("uicolor"),$("#layouts-set-div, #layouts-set-on2").hide(),$("#layouts-set-on").addClass("scale-out"),(a=CONFIG.kbd[e].size)&&(s=a.M||a.MU||-12,t=a.M||a.MD||-12,s=24+(54*a.Y-s-t),a.EY&&(s+=54*a.EY),a.MaskHeight&&(s=a.MaskHeight),$("#keyboard-outline").html(`<div class="keyboard-mask page-wd" style="height: ${s}px;"></div><div style="height:${s-30}px;"</div>`),t=54*a.Y/128,s=s/2-30,o=640,a.MaskHeight&&(o=640-1/(t=(a.MaskHeight-60)/128)*64),$("#loading").css({top:s+"px",left:o+"px",transform:`scale(${t})`}),$("#loading").show()),B(CONFIG.kbd[e].layout),CONFIG.kbd[e].firmware_url&&fetchHeader(CONFIG.kbd[e].firmware_url,"Last-Modified").then(function(e){e=format_date(new Date(e));$("#latest_firmware_date").hide(),$("#latest_firmware_date_short").hide(),$("#latest_firmware_date").text(e.long),$("#latest_firmware_date_short").text(e.short)}),"stm60"==f||"stm60c"==f?load_hex_uf2("./config/stm60_uf2.hex"):"uukb"==f?load_hex_uf2("./config/uukb_uf2.hex"):-1!=f.indexOf("simpo")&&load_hex_uf2("./config/simpo_uf2.hex"))}function A(){$("#keyboard-outline").css("display","none"),$("#keyboard-ledmap").css("display","block"),$("#keyboard-outline").find(".key").empty()}null!=t&&(keymaps=t,v=1),language=navigator.userLanguage||navigator.language||navigator.bowserLanguage,language="zh-cn"===language.toLowerCase()?"zh_cn":"en",window.onfocus=function(){},window.onblur=function(){$("#tabs-main").find(".keydown").removeClass("keydown"),l=0},$("#kbd-name-filter").bind("input propertychange",function(){kbd_name_filter($(this).val())}),$("#user-keycap-colors").bind("input propertychange",function(){user_keycap_colors($(this).val())}),$("#key-set-tabs").on("click","li a",function(){var e=$(this).attr("href");"#tabs-kbdinfo"==e?($("#keyboard-outline").find(".keyboard-mask").removeClass("hidef"),$("#keyboard-outline").find(".key-editing").removeClass("key-editing"),$("#keyboard-outline").find(".bl-key").css("z-index","12").find(".plate").css("background","red")):($("#keyboard-outline").find(".keyboard-mask").addClass("fade-out"),setTimeout(function(){$("#keyboard-outline").find(".keyboard-mask").removeClass("fade-out").addClass("hidef")},50),$("#keyboard-outline").find(".bl-key").css("z-index","").find(".plate").css("background","")),e.match(/#tabs-readme|#tabs-kbdinfo|#tabs-keycap/g)?($("#fn-set").hide(),$("#keycode_tabs").css("height","397px")):($("#fn-set").show(),$("#keycode_tabs").css("height","336px"))}),$("#firmware-dropdown").on("click","li",function(){var e,a,t=$(":hover");0==t[t.length-1].outerHTML.indexOf("<a ")?(a=$(this).attr("value"),CONFIG.kbd[a]&&f!=a&&(layouts_save="",h(f=a),$.cookie&&$.cookie("ck_select_kbd",f,{expires:365,path:"/"}))):t[t.length-1].outerHTML.includes("fav-kbd")&&$.cookie&&(a=$.cookie("fav_list"),e=(t=$(this).attr("value"))+" ",null!=a&&" "!=a||(a=""),$(this).find(".fav-kbd").hasClass("myfav")?($("#firmware-dropdown").find(`[value=${t}]`).find(".fav-kbd").each(function(){0==$(this).closest("#fav-kbd-list").length&&$(this).removeClass("myfav").text("favorite_border")}),t=new RegExp(e,"g"),a=a.replace(t,"").replace(/undefined/g,"").replace(/  /g,"")):($(this).find(".fav-kbd").addClass("myfav").text("favorite"),a+=e),fav_kbd_list_refresh(),$.cookie("fav_list",a,{expires:365,path:"/"}))}),$("#layouts-set-border, #keycap_color-userset-border").drags(),$("#layouts-set-on, #layouts-set-off, #layouts-set-on2").click(function(){fadeToggle($("#layouts-set-border")[0])}),$("#keycap_color-userset-on, #keycap_color-userset-off").click(function(){fadeToggle($("#keycap_color-userset-border")[0])}),$("input.jscolor, textarea.not_drag").on("mousemove",function(e){$(this).addClass("no_drag")}),$("input.jscolor, textarea.not_drag").on("mouseout",function(e){$(this).removeClass("no_drag")}),$(document).ready(function(){process_html_page(),$(".sidenav").sidenav(),$(".collapsible").collapsible(),$(".modal").modal(),$(".dropdown-trigger").dropdown({coverTrigger:!1}),$("#keymap-load-dropdown-btn, #download-share-dropdown-btn").dropdown({constrainWidth:!1,coverTrigger:!1}),$("#fn-set .dropdown-trigger").dropdown({closeOnClick:!1}),$(".fixed-action-btn.toolbar").floatingActionButton({toolbarEnabled:!0}),$(".fixed-action-btn.tips").floatingActionButton({hoverEnabled:!1,direction:"right"}),$(".fixed-action-btn.tips").find(".scale-transition").removeClass("scale-out");for(var e of KEYCAP_COLORS){e.order||(e.order=[0,1,1,0,1,0]);for(var a=new Array(0,0,0,0,0),t=0;t<6;t++)a[t]=e.value[e.order[t]];var s="";e.case_color&&(s=`case-color="${e.case_color}"`),$("#keycap-color-list").append(`<div class="keycap-color-block" ${s}>                                             <li class="key-color key-main" style="color:${a[0]}; background:${a[1]}">key</li>                                             <li class="key-color key-enter" style="color:${a[4]}; background:${a[5]}">enter</li>                                             <li class="key-color key-mod" style="color:${a[2]}; background:${a[3]}">${e.name}</li></div>`)}for(var o of UI_THEME)$("#ui-theme").append(`<li style="color:#fefefe; background-color:${o.color};"><a lang="zh_sc">`+o.name);fetch("./common/case_list.txt").then(checkResponse).then(parseTEXT).then(function(e){let a=e.split("\r\n");a.pop();for(var t of a)$("#mycase-style ul").append(`<li style="background-image: url(./common/case/${t}"><a>`)}),jsdef_init(),z(is_mac),R(0),U(),update_keycap_color(),K(),update_case_color(),G(),$("#setting-pane").show(),$(".tabs").tabs()}),$(".fixed-action-btn.tips").on("mousedown","ul li",function(e){n=$(this).children().hasClass("green"),$("#layer_set").tabs("select","layer_0")}),$("#keycap-color-list").on("click",".keycap-color-block",function(){now_keycap_color[0]=$(this).find(".key-main").css("color"),now_keycap_color[1]=$(this).find(".key-main").css("background"),now_keycap_color[2]=$(this).find(".key-mod").css("color"),now_keycap_color[3]=$(this).find(".key-mod").css("background"),now_keycap_color[4]=$(this).find(".key-enter").css("color"),now_keycap_color[5]=$(this).find(".key-enter").css("background");for(var e=0;e<6;e++){var a=now_keycap_color[e].match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/);function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}a&&(now_keycap_color[e]="#"+t(a[1])+t(a[2])+t(a[3]))}update_keycap_color(now_keycap_color),iscasejscolor||(s=$(this).attr("case-color")?$(this).attr("case-color"):now_keycap_color[1],$.cookie&&$.cookie("ck_case_color",s,{expires:365,path:"/"}),update_case_color(s))}),$("#casejscolor-toggle").click(function(){iscasejscolor=$(this).prop("checked"),$("#casejscolor-btn")[0].type=iscasejscolor?"show":"hidden"}),$("#ui-theme").on("click","li",function(){U($(this).css("background-color"))}),led_setting=20,$("#ledmap-setting").on("click",'[id^="indicator_dropdown-btn_"]',function(){led_setting=this.id.replace("indicator_dropdown-btn_","");var e;for(e of[{class_name:"can_disable",led_action_id:255},{class_name:"conn_mode",led_action_id:22},{class_name:"io_bt",led_action_id:20},{class_name:"io_ws2812",led_action_id:30}]){var a=$("#kb_ledmap-"+led_setting).hasClass(e.class_name)?"block":"none";$("#indicator_dropdown_menu").find(`[value=${e.led_action_id}]`).css({display:a})}}),$("[id^='indicator_dropdown_']").on("click","li",function(){update_indicator(led_setting,this.value)}),$("[id^='layouts-']").on("click","[class^='layouts-']",function(){var e=this.id.match(/layouts-(\d)(\d)/);if(0<$("#kblayouts-00").length){for(var a=0;a<$("div[id^='kblayouts-"+e[1]+"']").length;a++)$("#keyboard-outline").find(".akblayouts-"+e[1]+a).each(function(){$(this).hide()}),$("#kblayouts-"+e[1]+a).hide();$("#keyboard-outline").find(".akblayouts-"+e[1]+e[2]).each(function(){$(this).show()}),$("#kblayouts-"+e[1]+e[2]).show()}var t=layouts_save.match(/(\d)/g);layouts_save="",$("div[id^='kblayouts-']").each(function(){var e,a;"block"==$(this).css("display")&&(e=(a=this.id.match(/kblayouts-(\d)(\d)/))[1],a=a[2],t[e]=a)});for(a=0;a<t.length;a++)layouts_save+=t[a];keymaps[1][0][0]="1"+layouts_save>>16,keymaps[0][0][0]="1"+layouts_save&65535,$("#keyboard-outline").find(".keyboard-mask").addClass("hidef"),_()}),$("#mykeycap_change li a").click(function(){K(c=$(this).attr("value"))}),$("#lock_shift").click(function(){var e=$(this).hasClass("fa-unlock");$(this).toggleClass("fa-unlock",!e).toggleClass("fa-lock",e),$("#code-225").toggleClass("shift_locked",e),$(".key-set_shift_on").css("display",e?"block":"none"),$(".key-set_shift_off").css("display",e?"none":"block")}),$("#mykeycap_system_change").click(function(){"gmk"!=c&&K(c="gmk"),is_mac^=1,z(is_mac)}),$("#case-style-set").click(function(){$(".sidenav").sideNav("show")}),$("#mycase-style ul").on("click","li",function(){G($(this).css("background-image"))}),$(".layer").click(function(e,a){$("#keyboard-outline").css("display",""),$("#keyboard-ledmap").css("display","none");var t=parseInt($(this).attr("id").match(/layer-(\d+)/)[1]),s=t<d?"up":"down";d=t,$("#keyboard-outline").find(".keyboard-mask").addClass("hidef"),$("#keyboard-outline").find(".key").each(function(){$(this).removeClass("fade-in-down fade-in-up").addClass("fade-out-"+s).removeAttr("length stabilizer")}),setTimeout(function(){$("#keyboard-outline").find(".key").each(function(){$(this).removeClass("fade-out-down fade-out-up").addClass("fade-in-"+s)}),setTimeout(function(){$("#keyboard-outline").find(".key").removeClass("fade-in-down fade-in-up")},400),_(keymaps[t])},350),$("#keymap-layer-clear").hasClass("recovery")&&$("#keymap-layer-clear").removeClass("recovery").text("清空当前层设置")}),$("#ledmap-tab").click(function(e,a){A()}),$("#keyboard-outline").on("click",".kbd-led",function(e){var a=$(this).attr("class").match(/.*led(\d).*/);a&&a[1]<8&&(A(),$("#layer_set").tabs("select","ledmap_tab"))});function C(e){var a=r.match(/k([0-9a-v])([0-9a-v])/i);if(!a)throw"invalid id";return{row:parseInt(a[1],32),col:parseInt(a[2],32)}}var E,_=function(e){for(var a in null==e&&(e=keymaps[d]),$("#this_layout_keys").text("0"),$("#layout-info-pane").hasClass("showf")&&$("#layout-info-pane").removeClass("showf").addClass("hidef"),e)for(var t in e[a]){var s=e[a][t],t=parseInt(a).toString(32)+parseInt(t).toString(32),o=display_label(s,t);$(".key.k"+t).each(function(){var e,a=$(this).closest(".round"),a=(1==a.length&&(a.hasClass("cw")?e="zh_sc"==language?"顺时针旋: ":"Clockwise: ":a.hasClass("ccw")?e="zh_sc"==language?"逆时针旋: ":"Anticlockwise: ":a.hasClass("sw")&&(e="zh_sc"==language?"按下旋钮: ":"Button: "),o.desc=e+o.desc),$(this).closest(".square"));1==a.length&&(a.hasClass("upward")?e="zh_sc"==language?"向上滚动: ":"Upward: ":a.hasClass("dnward")?e="zh_sc"==language?"向下滚动: ":"Downward: ":a.hasClass("sw")&&(e="zh_sc"==language?"按下滚轮: ":"Button: "),o.desc=e+o.desc),$(this).html(o.name).attr("data-tooltip",o.desc),L($(this)[0],s)})}},w=($("#keyboard-outline").on("mouseover mouseout","[class^=mykeycap]",function(e){var a=$(this).find(".key"),t=a.attr("class").match(/k([0-9a-v][0-9a-v])/i),t=parseInt("0x"+t[1]);128!=t&&(t=keymaps[d][t>>4][15&t],"mouseover"==e.type&&(255<t||t<2)?(n||$("#keyfunction-display").html(a.attr("data-tooltip").replace("<br>","")).removeClass("hidef"),e.altKey&&($("#keyfunction-display")[0].innerHTML+="  Code:0x"+t.toString(16).toUpperCase())):"mouseout"==e.type&&$("#keyfunction-display").addClass("hidef"))}),$("#keycode_tabs").on("mouseover mouseout",".key-set",function(e){var a=$(this),t=a.attr("id").match(/code-((0x){0,1}[0-9a-fA-F]+)/)[1];"mouseover"==e.type&&(255<t||t<2)?$("#keyfunction-display").html(a.attr("title")).removeClass("hidef"):"mouseout"==e.type&&$("#keyfunction-display").addClass("hidef")}),$("#layer_set").on("mouseover mouseout",".layer",function(e){var t=parseInt($(this).attr("id").match(/layer-(\d+)/)[1]);t!=d&&"gmk"==c&&(i=t,"mouseover"==e.type?(e.shiftKey&&($("#layer_set").find(".bottom").removeClass("bottom"),$(this).addClass("bottom")),$("#keyboard-outline").find(".key:visible").each(function(){var e=this.className.match(/k([0-9a-v])([0-9a-v])/i),a=display_label(a=e[1]<8?keymaps[t][parseInt(e[1],32)][parseInt(e[2],32)]:a,e[0]),e=(a.name=a.name.replace(/fs(\d+)/g,"fs10").replace(/midfont/g,"bottomfont").replace(/bigfont/g,"bottomfont").replace(/<br>/g," ").replace("font-size","nofont").replace('<div style="height:15px"></div>',""),$(this).find(".bottom_content").remove(),this.title);$(this).append('<span class="bottom_content">'+a.name),$(this).attr("title",e)})):"mouseout"==e.type&&(e.shiftKey?(console.log("keep layer "+t),$("#layer_set").find(".layer").each(function(){console.log(this.id),this.id=="layer-"+t?$(this).addClass("bottom"):$(this).removeClass("bottom")})):(i=255,$("#keyboard-outline").find(".bottom_content").remove(),$("#layer_set").find(".bottom").removeClass("bottom"))))}),$("#layouts-set").on("mouseover mouseout","label span",function(e){var a=$(this).attr("for"),t=(console.log(a),$("#keyboard-outline").find("#kb"+a));t&&("mouseover"!=e.type||$("#layouts-set").find("#"+a).prop("checked")?"mouseout"==e.type&&($("#keyboard-outline").find(".keyboard-mask").addClass("hidef"),t.find("[class^=mykeycap]").each(function(e){$(this).css("z-index","")}),$("#layouts-set").find("#"+a).prop("checked")||t.hide()):($("#keyboard-outline").find(".keyboard-mask").removeClass("hidef"),t.show(),t.find("[class^=mykeycap]").each(function(e){$(this).css("z-index","12")})))}),$("#keycode_tabs").on("click",".key-set",function(e,a){var t,s=parseInt($(this).attr("id").match(/code-((0x){0,1}[0-9a-fA-F]+)/)[1]);if(l&&s<152&&(s|=(15&l)<<8),4==l&&61440==(61694&s)&&61696<=s&&(s|=l<<8),R(s),s<=255&&($("#tabs-main").find(`[id=code-${s}]`).each(function(e){$(this).removeClass("keydown")}),224<=s&&s<=229&&(l&=~(1<<s-224))),!r)return t="zh_sc"==language?"请先在上方选择要修改的按键!":"Please select the key you want to modify at first!",void M.toast({html:t,classes:"rounded",displayLength:"1000"});$(this).blur(),S(s)}),0),T=0,m=0,S=(document.addEventListener("keydown",function(e){var a=e.keyCode,t=keyCode2tmkCode(256*e.location+a);230==t&&(w&&(T=1),15!=l&&23!=l||(w=1));T?(224<=t&&t<=229&&(l|=1<<t-224),e.returnValue=!1):(console.log(`KeyDN:js keycode: 0x${(256*e.location+a).toString(16)}. Key:`+[tmkCode2keyName(t)]),$("#tabs-main").find("[id=code-"+t+"]").each(function(e){$(this).addClass("keydown")}),224<=t&&t<=229&&(l|=1<<t-224),4<$(":hover").length&&"keyboard-outline"==$(":hover")[4].id&&(e.returnValue=!1,r&&(t<224||228<=t)&&!l&&S(t)))}),document.addEventListener("keyup",function(e){var a,t,s,o,n,d=e.keyCode,i=keyCode2tmkCode(256*e.location+d),c=l;230==i&&T?(l=T=0,n=parseInt(m/4),s=parseInt(n/128),o=parseInt(n/16)%8,n=n%16,0==m&&(u=[no_map(),no_map(),no_map(),no_map(),no_map(),no_map(),no_map(),no_map()]),m%4==0?5==c?(m+=3,u[s][o][n]=1):6==c?(m++,u[s][o][n]=0):u[s][o][n]|=c:m%4==1?u[s][o][n]|=c<<2:m%4==2?6==c?k++:u[s][o][n]|=c<<8:m%4==3&&(u[s][o][n]|=c<<10),m%4==3&&(a=("0000000000000000"+u[s][o][n].toString(2)).slice(-16),t=("0"+parseInt(m/40.95)).slice(-2),$("#keyfunction-display").removeClass("hidef").html(`接收完成前请勿操作电脑，接收按键设置 <span style='font-family:"Consolas", Sans-serif'> ${t}%  KEY[${s}][${o}][${("0"+n).slice(-2)}]: ${a}</span>`)),4096==++m&&($("#keyfunction-display").html("接收按键完成"),$("#keyfunction-display").addClass("hidef"),w=m=0,D()),e.returnValue=!1):0==m&&(console.log(`KeyUP:js keycode: 0x${(256*e.location+d).toString(16)}. Key:`+tmkCode2keyName(i)),$("#tabs-main").find("[id=code-"+i+"]").each(function(e){$(this).removeClass("keydown")}),224<=i&&i<=229&&(l&=~(1<<i-224)),4<$(":hover").length&&"keyboard-outline"==$(":hover")[4].id&&(e.returnValue=!1,r&&(c&&i<224&&S(l<<8|i),!l&&(70==i||224<=i)&&S(i))))}),document.oncontextmenu=function(e){var a=$(":hover");if(event.shiftKey&&6<a.length)for(var t=6;t<a.length-1;t++){var s,o,n=a[t].className.match(/mykeycap(\d)/);if(n)return s=$('[class="'+a[t].className+'"]'),3<(o=parseInt(n[1])+1)&&(o=1),s.removeClass(n[0]),s.addClass("mykeycap"+o),!1}},function(e){var a,t,s,o,n=$("#keyboard-outline").find(".key-editing");n&&r&&(l&&2<=e&&e<=255&&(e|=l<<8),s=C(),o=parseInt(s.row).toString(32)+parseInt(s.col).toString(32),new Action(keymaps[d][s.row][s.col]=e),t=display_label(e,o),a=t.name,t=t.desc,i<8&&i!=d&&((s=display_label(keymaps[i][s.row][s.col],o)).name=s.name.replace(/fs(\d+)/g,"fs10").replace(/midfont/g,"bottomfont").replace(/bigfont/g,"bottomfont").replace(/<br>/g," ").replace("font-size","nofont").replace('<div style="height:15px"></div>',""),a+='<span class="bottom_content">'+s.name),$("."+r).each(function(){var e=$(this);e.removeClass("fade-in-down fade-in-up").addClass("fade-out-down"),setTimeout(function(){e.removeClass("fade-out-down fade-out-up").addClass("fade-in-down").html(a),setTimeout(function(){e.removeClass("fade-in-down fade-in-up")},350)},300)}),$("."+r).attr("data-tooltip",t),(o=n.find(".key"))&&L(o[0],e),$("."+r).focus(),$("#keyboard-outline").find(".key-editing").removeClass("key-editing"),r=null)});function L(e,a){var t=M.Tooltip.getInstance(e);(e.parentElement.parentElement.parentElement.classList.contains("round")||100==a||255<a)&&n?null==t&&(t=M.Tooltip.init(e)):t&&t.destroy()}function O(e){var a;if(keycodes[e]&&!(255<e))return e<101?(a=keycodes[e].desc,e<2&&(a=keycodes[e].id)):a=keycodes[e].name,a=is_mac&&keycodes[e].name_mac?keycodes[e].name_mac:a}for(E in $("#advanced-mode-toggle").click(function(){$("#advanced-mode-layer").css("display",$(this).prop("checked")?"block":"none")}),$("#keymap-layer-copy").click(function(){a=Array.from(keymaps[d]),$("#copied-layer_1, #copied-layer_2").text(d)}),$("#keymap-layer-paste").click(function(){keymaps[d]=Array.from(a),_()}),$("#keymap-layer-clear").click(function(){$(this).hasClass("recovery")?($(this).removeClass("recovery").text("清空当前层设置"),keymaps[d]=Array.from(a)):($(this).addClass("recovery").text("恢复当前层设置"),a=Array.from(keymaps[d]),keymaps[d]=Array.from(transparent_map())),_()}),$("#keymap-layer-exchange").click(function(){var e=$("#copied-layer_1").text(),a=keymaps[d];keymaps[d]=keymaps[e],keymaps[e]=a,_()}),$("#preset-keymap-list").on("click","li",function(){var e=url_decode_keymap($("#keyboard-outline").find("[id^='kb-preset_keymap-"+this.value+"']").attr("value-keymap").replace(/YDKB/g,"+"));null!=e&&(u=e,console.log(u)),D(),_()}),$(".editor_dropdown").hide(),action_kinds)$("#kind_dropdown").append('<li value="{0}" class="tooltipped" data-tooltip="{1}" data-position="right" lang="zh_sc"> <a lang="zh_sc"> {2}'.format(action_kinds[E].id,action_kinds[E].desc,action_kinds[E].name));for(e in $("#kind_dropdown").find('[value^="OPT_GROUP"]').addClass("disabled optgroup uicolor-text").removeClass("tooltipped"),$("#kind_dropdown").find('[value="UNKNOWN"]').addClass("hide"),keycodes)2!=e&&3!=e&&e<255&&($("#keycodes_dropdown").append(b(e,keycodes[e].desc,O(e))),e<176&&$("#keycodes4tap_dropdown").append(b(e,keycodes[e].desc,O(e))));for(var e,k=0;k<8;k++)$("#layer_dropdown").append(b(k,"Layer "+k,"Layer "+k)),$("#layer_tap_dropdown").prepend(b(7-k,"Layer "+(7-k),"Layer "+(7-k))),$("#layer_tap_dropdown").append(b(k+8,"Layer "+k+"(S)","Layer "+k+"(S)"));for(e in on_codes)$("#layer_on_dropdown").append(b(e,on_codes[e].desc,on_codes[e].name));for(k=0;k<100;k++){var P=("0"+k).slice(-2);$("#launch_shortcut_dropdown").append(b("0x47"+P,"Launch Shortcut "+P,"Shortcut "+P))}var R=function(e){var a=new Action(e),t=(new Action(255&e),$("#kind_dropdown").find("[value="+a.id+"]").text()),t=($("#kind_dropdown-btn").html(t).attr({value:a.id}),$("#fn-set").find("ul li").removeClass("uicolor").removeAttr("style"),$("#kind_dropdown").find("[value="+a.id+"]").addClass("uicolor"),$("#kind_dropdown").trigger("change"),O(e)),t=(255<e&&e<53248&&(t=O(255&e)),$("#keycodes_dropdown-btn").html(t).attr({value:a.key_code}),$("#keycodes_dropdown").find("[value="+a.key_code+"]").addClass("uicolor"),(255&e)<176&&($("#keycodes4tap_dropdown-btn").html(t).attr({value:a.key_code}),$("#keycodes4tap_dropdown").find("[value="+a.key_code+"]").addClass("uicolor")),a.id&&a.id.match(/(.*?)MOD(.*?)/)?mods_codes[e>>8&31].name:"");$("#key_mods_dropdown-btn").html(t).attr({value:a.key_mods});for(var s=0;s<5;s++){var o=1<<s;$("#key_mods_dropdown").find("[value="+o+"]").prop("checked",a.key_mods&o)}$("#key_mods_dropdown").find("[value=0]").prop("checked",a.key_mods<16),$("#key_mods_dropdown").find("[value=0x10]").prop("checked",16<a.key_mods);var n="",d=0,i=($("#key_mods_dropdown input:checked").each(function(e,a){d|=$(this).val(),0<$(this).val()&&$(this).val()<16&&(n+=(d<16?"":"r")+$(this).parent().text()+"+")}),2<n.length&&$("#key_mods_dropdown-btn").html(n.slice(0,-1)),a.layer_tap_val<16?a.layer_tap_val:0);if("LAYER_TOGGLE"==a.id||"DEFAULT_LAYER_SET"==a.id){for(var c=15&e;c>>1;c>>=1)i++;i+=4*((224&e)>>5)}"LAYER_TOGGLE"==a.id?i-=10:"DEFAULT_LAYER_SET"==a.id&&(i-=12),$("#layer_dropdown-btn").html("Layer "+i).attr({value:i}),$("#layer_dropdown").find("[value="+i+"]").addClass("uicolor"),(i<8?$("#layer_tap_dropdown-btn").html("Layer "+i):$("#layer_tap_dropdown-btn").html("Layer "+(i-8)+"(S)")).attr({value:i}),$("#layer_tap_dropdown").find("[value="+i+"]").addClass("uicolor"),$("#layer_mods_dropdown-btn").html(t).attr({value:15&a.layer_tap_code});for(s=0;s<5;s++){o=1<<s;$("#layer_mods_dropdown").find("[value="+o+"]").prop("checked",15&a.layer_tap_code&o)}n="",d=0,$("#layer_mods_dropdown input:checked").each(function(e,a){0<$(this).val()&&$(this).val()<16&&(n+=$(this).parent().text()+"+")}),2<n.length&&$("#layer_mods_dropdown-btn").html(n.slice(0,-1)),$("#layer_on_dropdown-btn").html("Layer "+a.layer_bitop_op).attr({value:a.layer_bitop_op}),$.cookie("uicolor")&&$("#fn-set").find("ul li.uicolor").css({"background-color":$.cookie("uicolor")})},Y=($("[id$=dropdown-btn]").on("click",function(){var e=this.id.replace("-btn","");$("[id$=dropdown]").hide(),$("#"+e).show()}),$("#fn-set").find("[id$=_dropdown]").on("click","li",function(){var t,s,e=$(this).offsetParent().attr("id"),a=$(this).attr("value"),a=($("#fn-set").find("#"+e+"-btn").text($(this).text()).attr({value:a}),$("#"+e).find("li").removeClass("uicolor").removeAttr("style"),$("#"+e).find("[value="+a+"]").addClass("uicolor"),$.cookie("uicolor")&&$("#fn-set #"+e).find("[value="+a+"]").css({"background-color":$.cookie("uicolor")}),$("#kind_dropdown").trigger("change"),$("#"+e+"-btn"));a&&-1==e.indexOf("_mods_")&&M.Dropdown.getInstance(a[0]).close(),"key_mods_dropdown"!=e&&"layer_mods_dropdown"!=e||(t=0,s="",$(this).find("input[type=checkbox]").prop("checked",!$(this).find("input[type=checkbox]").prop("checked")),$("#"+e+" input:checked").each(function(e,a){t|=$(this).val(),0<$(this).val()&&$(this).val()<16&&(s+=(t<16?"":"r")+$(this).parent().text()+"+")}),$("#fn-set").find("#"+e+"-btn").text(s.slice(0,-1)).attr({value:t}))}),$("#fn-set").find("button.action-apply").click(function(e){var a;r&&(a=action_editor_get_code(),S(a))}),[]),N=[],u=[];function F(e){return fetch(e).then(checkResponse).then(parseTEXT).then(function(e){var a,t=hex_split_firmware(e,KEYMAP_START_ADDRESS,KEYMAP_SIZE);return Y=t.before,N=t.after,!v&&0<$("#kb-preset_keymap-0").length?(console.log("load keymap0"),null!=(a=url_decode_keymap($("#kb-preset_keymap-0").attr("value-keymap").replace(/YDKB/g,"+")))&&(u=a)):(u=v?keymaps:t.keymaps,D()),console4jslang&&!v&&0<$("#yang_keymap").length&&(null!=(a=url_decode_keymap($("#yang_keymap").attr("value-keymap").replace(/YDKB/g,"+")))&&(u=a),$("#yang_keymap").remove()),0!=t.date?((a={}).short=shorten_date(t.date[0])+shorten_date(t.date[1])+shorten_date(t.date[2]),a.long="20"+t.date[0]+"-"+t.date[1]+"-"+t.date[2]+$("#latest_firmware_date").text().slice(10),$("#latest_firmware_date").text(a.long),$("#latest_firmware_date_short").text(a.short),console.log(t.date)):($("#latest_firmware_date").text("2020"),$("#latest_firmware_date_short").text("2020")),$("#latest_firmware_date").show(),$("#latest_firmware_date_short").show(),e}).catch(function(e){console.log("request failed",e)})}$("#firmwareFile").change(function(e){var c=e.target.files[0];c?((e=new FileReader).onloadend=function(e){var a,t,s=c.name.toLowerCase();if(s.match(/.hex/g)?(t=convert_hex2bin(this.result,0,0),console.log(t.length),t=31744==t.length?hex_split_firmware(this.result,29696,2048):hex_split_firmware(this.result,KEYMAP_START_ADDRESS,KEYMAP_SIZE)):s.match(/.uf2/g)?t=bin_split_firmware((a=uf2_to_bin(this.result)).binstr,KEYMAP_START_ADDRESS,KEYMAP_SIZE,a.bin_start_addr):s.match(/.bin/g)&&(t=bin_split_firmware(this.result,KEYMAP_START_ADDRESS,KEYMAP_SIZE)),u=t.keymaps,console.log(u),"udock"==f){var o=t.after;if(0<o.length&&205==o[0]){for(var n=o[1]|o[2]<<8,d="",i=0;i<n;i++)d+=String.fromCharCode(o[i+3]);x(p=unzip(d))}}$("#keymap-load").prop("disabled",!1),$("#keymap-load-div").show(),D(),_()},e.readAsBinaryString(c),$("#firmwareFile").val("")):$("#keymap-load").prop("disabled",!0)}),$("#keymap-load").prop("disabled",!0),$("#keymap-load").click(function(e,a){D()});var D=function(){for(keymaps=$.extend(!0,[],u);keymaps.length<KEYMAP_LAYERS;)keymaps.push(transparent_map());var e=""+parseInt(keymaps[1][0][0]<<16|keymaps[0][0][0]);if(console.log(parseInt(g)+1+" layouts:"+e),"1"==e.slice(0,1)&&e.length-2==g){var a=e.slice(1).match(/(\d)/g);0==layouts_save&&(layouts_save=e.slice(1));for(var t=0;t<g+1;t++){for(var s=0;s<$("div[id^='kblayouts-"+t+"']").length+1;s++)$("#kblayouts-"+t+s).hide(),$("#layouts-"+t+s).prop({checked:"false"}),$("#keyboard-outline").find(".akblayouts-"+t+s).hide();$("#kblayouts-"+t+a[t]).show(),$("#layouts-"+t+a[t]).prop({checked:"checked"}),$("#keyboard-outline").find(".akblayouts-"+t+a[t]).show()}}update_indicator(10),update_indicator_color(10)};function x(e){var a=$("#keyboard-outline")[0].offsetHeight,e=($("#kbd-layout").empty(),$("#kbd-layout").append(e),$("#kbd-layout").find("[class^=mykeycap]").each(function(){var e=keyName2tmkCode($(this).text().toUpperCase()).toLowerCase();$(this).empty(),$(this).append('<div class="plate"></div><div class="border"><div class="top"><div class="key k{0}">'.format(e))}),_(),$("#keyboard-outline")[0].offsetHeight),t=$("#keyboard-outline").find(".keyboard-mask");t.css("height",parseInt(t.css("height"))+e-a+"px")}$("#keyboard-outline").on("change","#layoutFile",function(e,a){var t=e.target.files[0];t&&((e=new FileReader).onloadend=function(e){t.name.match(/.html/g)&&(this.result.match(/(mykeycap.*)/)?x(p=this.result):alert(window.lang.translate("不是布局文件")))},e.readAsBinaryString(t),$("#layoutFile").val(""))}),$("#hex-download").prop("disabled",!0),$("#hex-download, #bin-download, #uf2-download").click(function(e,l){$("#firmwareFile")[0].files[0]&&$("#firmwareFile")[0].files[0].name.match(/\.hex/)&&console.log("hex file");var a=".hex";if("uf2-download"==this.id)var t=[].concat(firmware_before_uf2).concat(hex_keymaps(KEYMAP_START_ADDRESS)),s=convert_hex2bin(t,16384,KEYMAP_START_ADDRESS+KEYMAP_SIZE),o=(console.log(s),1591873650),n=$("#kbd-firmware"),n=(n.attr("value-family-id")&&(o=parseInt(n.attr("value-family-id"),16)),console.log("0x"+o.toString(16)),bin_to_uf2(s,134234112,o)),o=new Blob([n],{type:"application/octet-stream"}),a=".uf2";else if("bin-download"==this.id){t=[].concat(Y).concat(hex_keymaps(KEYMAP_START_ADDRESS)),n=0,s=("yd1800mini"!=f&&"master98"!=f&&"sairo64"!=f&&"x8086k"!=f&&"u2u_pro"!=f&&"udock"!=f||(n=57344),convert_hex2bin(t,0,KEYMAP_START_ADDRESS+KEYMAP_SIZE+n));if("udock"==f&&0<p.length){var d=zip(p);console.log(p.length+" to "+d.length),s[65536]=205,s[65537]=255&d.length,s[65538]=d.length>>8;for(var i=0;i<d.length;i++)s[65539+i]=d[i].charCodeAt()}t=CONFIG.kbd[f].checksum;if(t){var c=0;for(k=0;k<s.length;k++){var r=s[k];word=1&k?r<<8:r,c+=word}n=s[t.addr]|s[t.addr+1]<<8,n=t.value-(c-=n)&65535;e.shiftKey&e.altKey&&(n=0),s[t.addr]=255&n,s[t.addr+1]=n>>8}if(o=new Blob([s],{type:"application/octet-stream"}),a=".BIN",s[0]==s[1]&&s[1]==s[2])return void alert(window.lang.translate("下载文件有错，Ctrl+F5刷新页面后重试"))}else{e=[].concat(Y).concat(hex_keymaps(KEYMAP_START_ADDRESS)).concat(N).join("\r\n").concat("\r\n");o=new Blob([e],{type:"application/octet-stream"})}t=$("#kbd-firmware").attr("value-filename");null==t&&(t=f,"bin-download"==this.id&&(t=t.toUpperCase())),saveAs(o,t+a)}),$("#share-dialog-btn").click(function(){update_share_url_panel()}),$("#keymap-share, #shorten-url").click(function(e,a){var t,s=zip(JSON.stringify(keymaps)),s=document.location.origin+document.location.pathname+"?"+(f+(0<$("#kblayouts-00").length?"-"+layouts_save:""))+"#"+s;"shorten-url"==this.id?(t=s.replace(/\&/g,"%26").replace(/\#/g,"%23").replace(/\+/g,"YDKB"),$jsonp.send("https://api.suowo.cn/api.htm?format=jsonp&url="+t+"&callback=data&key=5f44e5d0b1b63c19739624a8@588c8ec49f482d6299e8d1b4a9f68a2f&expireDate=2030-03-31&domain=0",{callbackName:"data",onSuccess:function(e){$("#share-url").val(e.url),M.textareaAutoResize($("#share-url"))},onTimeout:function(){console.log("timeout!")},timeout:5}),$("#share-dialog").removeClass("url-long")):($("#share-url").val(s),M.textareaAutoResize($("#share-url")),$("#share-dialog").addClass("url-long")),update_share_url_panel()}),$("#output-c").click(function(e,a){0<$("#keymap-c").text().length?$("#keymap-c").text(""):(keymaps[7][0][0]=0,$("#keymap-c").text(source_output(keymaps))),M.textareaAutoResize($("#keymap-c"))}),$(window).bind("beforeunload",function(){return"CAUTION: You will lost your change."}),$("#show-tabs-kbdinfo").click(function(e,a){$("#key-set-tabs").tabs("select","tabs-kbdinfo")});var y=$.Deferred().resolve(),B=(CONFIG.kbd[variant]&&CONFIG.kbd[variant].firmware_url&&($("#firmware-dropdown").val(variant),y=F(CONFIG.kbd[variant].firmware_url).then(function(e){if(!document.location.hash)for(keymaps=$.extend(!0,[],u);keymaps.length<KEYMAP_LAYERS;)keymaps.push(transparent_map());$("#hex-download").prop("disabled",!1),$("#keymap-load").prop("disabled",!1)})),function(e){var i,c,r,l,_,m,u,p=CONFIG.kbd[f].size,y=(p&&(p.M?i=c=r=l=p.M:(i=p.MU||-12,c=p.MR||-12,r=p.MD||-12,l=p.ML||-12),_=p.BR||-l-6,m=54*p.X-l-c,u=54*p.Y-i-r),$(".keyboard-mask")[0]),h=y?y.offsetHeight:0;fetch(e).then(checkResponse).then(parseTEXT).then(function(e){$("#keyboard-outline").html(e),p&&($("#keyboard-outline").prepend(y),p.AutoCase&&(e=`height: ${h-30}px; width: 54px; padding: ${-i-8}px 0 0 ${640-27*p.X}px;`,$("#mykbd").attr("style",e),e=`<div class="{0}" style="margin: ${i}px ${c}px ${r}px ${l}px; height: ${u}px; width: ${m}px; border-radius: ${_}px">`,$("#mycase").prepend(e.format("kbdbg-mask")).prepend(e.format("kbdbg-border"))));var e=$("#kbd-firmware");KEYMAP_START_ADDRESS=e.attr("value-keymapaddr")?parseInt(e.attr("value-keymapaddr"),16):26624,console.log("KEYMAP_ADDR: 0x"+KEYMAP_START_ADDRESS.toString(16)),F(CONFIG.kbd[f].firmware_url).then(function(e){v||(D(),$("#advanced-mode-toggle").prop("checked")&&(v=1)),$("#layer_set").tabs("select","layer_0"),$("#keyboard-outline").find(".keyboard-mask").addClass("hidef"),setTimeout(function(){$("#loading").hide()},600),setTimeout(function(){first_visit()},800)}),$("#tool-download").parent().show(),$("#hex-download").parent().show(),$("#bin-download").parent().hide(),$("#uf2-download").parent().hide(),e.attr("value-format")&&($("#tool-download").parent().hide(),e=e.attr("value-format"),console.log("Firmware format: "+e),e.match(/bin/g)&&($("#bin-download").parent().show(),console4jslang||$("#hex-download").parent().hide()),e.match(/uf2/g)&&($("#uf2-download").parent().show(),console4jslang||$("#hex-download").parent().hide()),e.match(/hex/g)&&($("#hex-download").parent().show(),$("#tool-download").parent().show())),$("#keyboard-outline").find("[class^=mykeycap]").each(function(){var e,a=keyName2tmkCode($(this).text().toUpperCase()).toLowerCase(),a=($(this).empty(),$(this).append('<div class="plate"></div><div class="border"><div class="top"><div class="key k{0}">'.format(a)),$(this).attr("class").match(/.*(led(\d)).*/));a&&($(this).removeClass(a[1]).find(".border").prepend(`<div class="kbd-led ${a[1]}">`),$(this).hasClass("suden")&&$(this).removeClass("suden").find(".kbd-led").addClass("suden"),7<a[2]&&(a=$(this).attr("data-tooltip"),e=$(this).attr("led-color")||"red",$(this).removeAttr("data-tooltip led-color").find(".kbd-led").attr("data-tooltip",a).css("background-color",e)))}),$("#keyboard-outline").find(".kbd-led").each(function(){$(this).attr("class").match(/.*(led(\d)).*/)&&$(this).addClass("tooltipped").attr("data-position","left")});var a,t,s,o,n,e=$("#kbd-info").attr("value-type"),d=(e?(null==(n=$("#kbd-firmware").attr("value-filename"))&&(n=CONFIG.kbd[f].name,(d=$("#kbd-firmware").attr("value-filename"))&&(n=d),"lufa_msd_ble"==e&&(n=n.toUpperCase())),d=$("#kbd-firmware").attr("value-diskname"),a=n,t=d=null==d?n:d,s=e,fetch("config/templates_bootloader.html").then(checkResponse).then(parseTEXT).then(function(e){e=$(e);I($(e).find("#"+s).html().replace(/BIN_NAME/g,a).replace(/DISK_NAME/g,t)),onLangChange(language)})):(n=$("#kbd-info").html(),$("#kbd-info").remove(),$("#kbdinfo_detail").empty(),n?I(n):$("#kbdinfo_detail").append("暂无其他说明")),$("#purchase-link").empty(),$("#purchase-link").append(`<li class="waves-effect waves-light"><a href="#!">尊重劳动成果，远离山寨。右侧为 ${CONFIG.kbd[f].name} 正规购买渠道和介绍。`),$("[id^='kbd-purchase_link_']"));$(".fixed-action-btn.toolbar").find(".scale-transition").toggleClass("scale-out",0==d.length),d.each(function(e){$("#purchase-link").append(`<li class="waves-effect waves-light"><a href=${$(this).attr("value")} target="_blank">`+$(this).text()),$(this).remove()}),$("#macrofn").empty(),$("#macrofn").html($("#kbd-macrofn").html().replace(/\(R\)/g,"<SUB> (R)</SUB>").replace(/\(L\)/g,"<SUB> (L)</SUB>")),$("#macrofn").find('[id^="code-"]').addClass("key-set").attr("lang","zh_sc"),$("#kbd-macrofn").remove(),0<$("#kblayouts-00").length&&($("#layouts-set-div, #layouts-set-on2").show(),$("#layouts-set-on").removeClass("scale-out"),$("#layouts-set").empty(),layouts_save&&(o=layouts_save.match(/(\d)/g)),g=0,$("div[id^='kblayouts-']").each(function(){var e=this.id.match(/kblayouts-(\d)(\d)/),a=e[1],e=e[2];g<a&&(g=a),0==e&&($("#layouts-set").append('<div class="rowstart">[ '+$(this).attr("value-desc")+" ]"),$("#layouts-set").append('<div id="layouts-'+a+'">'),o&&o[a]||(layouts_save+="0")),$("#layouts-"+a).append('<label><input type="radio" id="layouts-'+a+e+'" class="layouts-'+a+' with-gap" name="layouts-'+a+'"/><span for="layouts-'+a+e+'">'+$(this).attr("value-name")),o&&o[a]&&($("#kblayouts-"+a+"0").hide(),$("#kblayouts-"+a+o[a]).show()),"block"==$(this).css("display")&&$("#layouts-"+a+e).prop({checked:"checked"})})),$("#ledmap-tab,[id^='indicator_dropdown-'], [id^='indicator-color-']").each(function(){$(this).hide()}),0<$("#kb_ledmap-0").length&&($("#ledmap-tab").show(),$("[id^='kb_ledmap-']").each(function(){var e=this.id.replace("kb_ledmap-","");$("#indicator_dropdown-name_"+e).show().text($(this).text()).attr({"data-tooltip":$(this).attr("title")}),$("#indicator_dropdown-btn_"+e).show(),$(this).hasClass("rgb_color")&&$("#indicator-color-btn_"+e).show(),v||update_indicator(e,this.value)})),$("#preset-keymap-group").hide(),$("#preset-keymap-list").empty(),0<$("#kb-preset_keymap").length&&($("#preset-keymap-group").show(),$("[id^='kb-preset_keymap-']").each(function(){var e=this.id.replace("kb-preset_keymap-","");$("#preset-keymap-list").append(b(e,this.title,'<i class="material-icons mr5">cloud_download</i>'+$(this).text()))})),0<$("#kb-changelog-url").length?(d="help/#/changelog/"+((n=(e=$("#kb-changelog-url").attr("href")).match(/.*?changelog:(.*)/))&&1<n.length?n[1]:e),$("#latest_firmware_changelog").attr("href",d).attr("target","_blank").show()):$("#latest_firmware_changelog").removeAttr("href target").hide(),onLangChange(language),fetch("/config/templates_led_fn.html").then(checkResponse).then(parseTEXT).then(function(e){var a=$(e),t=["#backlight_control_keys","#ble51_control_keys","#ble51_control_keys_v2","#ble51_control_keys_v3","#rgb_control_keys"];for(k in t)$(t[k]).each(function(){var e=$(a).find(t[k]).html();$(this).html(e)})})}).catch(function(e){console.log("request failed",e)})});function I(e){e=e.replace("https://ydkb.io/","/"),$("#kbdinfo_detail").html(e),init_space($("#kbdinfo_detail")),$("#kbdinfo_detail").html($("#kbdinfo_detail").html().replaceAll("<hanla></hanla>"," "))}function b(e,a,t){return`<li value="${e}" title="${a}" lang="zh_sc"> <a lang="zh_sc">`+t}function U(e){$.cookie&&(null==e?e=$.cookie("uicolor"):$.cookie("uicolor",e,{expires:365,path:"/"})),e&&(document.documentElement.style.setProperty("--uicolor",e),$("html").toggleClass("dark-mode","rgb(36, 36, 36)"==e.toString()))}function G(e){$.cookie?null==e?e=$.cookie("ck_case_style"):$.cookie("ck_case_style",e,{expires:365,path:"/"}):null==e&&o&&(e=o),e&&(document.documentElement.style.setProperty("--mycase-background-image",e),o=e)}function K(e){var a,t;$.cookie?null==e?(e=$.cookie("ck_keycap_style"),c=e):$.cookie("ck_keycap_style",e,{expires:365,path:"/"}):null==e&&o&&(e=c),e&&null!=e&&($("#keycap_style_gmk").remove(),$("#keycap_style_flat").remove(),a='<link id="keycap_style_flat" href="flat.css" rel="stylesheet">',t='<link id="keycap_style_gmk" href="gmk.css" rel="stylesheet">',"gmk"==e?($(a).appendTo("head"),$(t).appendTo("head")):"flat"==e?($(t).appendTo("head"),$(a).appendTo("head")):"dsa"==e&&($('<link id="keycap_style_gmk" class="nowdsa" href="gmk.css" rel="stylesheet">').prependTo("head"),$(a).prependTo("head")),_())}function z(a){$("#keyboard-outline").find(".key:visible").toggleClass("fade-in-down",a).toggleClass("fade-in-up",!a),setTimeout(function(){$("#keyboard-outline").find(".key").removeClass("fade-in-down fade-in-up")},400),_();var e,t=a?"none":"block",s=a?"block":"none";for(e in $("#tabs-main").find(".name_win").each(function(){$(this).css("display",t)}),$("#tabs-main").find(".name_mac").each(function(){$(this).css("display",s)}),$("#mykeycap_system_change button").removeClass("using"),(a?$("#system_mac"):$("#system_win")).addClass("using"),keycodes)keycodes[e].desc_mac&&$("#keycodes_dropdown, #keycodes4tap_dropdown").find("[value="+e+"]").attr("title",a?keycodes[e].desc_mac:keycodes[e].desc).find("a").text(O(e));$("#key_mods_dropdown, #layer_mods_dropdown").find("label").each(function(){var e=$(this).html();a?$(this).html(e.replace("Alt","Option").replace("Win","Cmd")):$(this).html(e.replace("Option","Alt").replace("Cmd","Win"))}),$(".key-set").each(function(e){var a=display_label(parseInt($(this).attr("id").match(/code-((0x){0,1}[0-9a-fA-F]+)/)[1]),0);$(this).attr({title:a.desc}),$(this).attr("key")&&$(this).html(a.name)})}$.when(y).then(function(){variant?f=variant:$.cookie&&$.cookie("ck_select_kbd")&&(f=$.cookie("ck_select_kbd")),h(f)}),$("#keyboard-outline").on("mousedown","[class^='mykeycap']",function(e){var a;2!=e.button&&($("#kbdinfo_tab").hasClass("active")||((a=$(":hover"))[a.length-1].className.match("kbd-led")||"k80"!=(r=$(this).find(".key")[0].classList[1])&&($(this).hasClass("key-editing")?($(this).removeClass("key-editing"),r=null):($("#keyboard-outline").find(".key-editing").removeClass("key-editing"),$("[id$=dropdown]").hide(),$(this).addClass("key-editing"),a=C(),a=keymaps[d][a.row][a.col],R(a)),1==e.button&&(e.preventDefault(),e.shiftKey?S(0):S(1)),$(this).blur())))}),$("#import-user-keycap-colors").click(function(e,a){console.log($("#user-keycap-colors").val());var t=$("#user-keycap-colors").val().split(",");t instanceof Array&&6==t.length&&update_keycap_color(t)})});var action_kinds={KEY:{id:"KEY",name:"常规按键",desc:"常规按键"},MODS_KEY:{id:"MODS_KEY",name:"修饰键（组合键）",desc:"修饰键，指ctrl shift alt(option) win(command)这些"},LAYER_MOMENTARY:{id:"LAYER_MOMENTARY",name:"瞬时开启层",desc:"按下按键时瞬时开启层，放开按键时层会关闭"},LAYER_TOGGLE:{id:"LAYER_TOGGLE",name:"层开关",desc:"切换层开关"},LAYER_MODS:{id:"LAYER_MODS",name:"修饰键 & 瞬时开启层",desc:"瞬时开启层的同时按下修饰键(目前仅支持左修饰键)"},DEFAULT_LAYER_SET:{id:"DEFAULT_LAYER_SET",name:"设置默认层",desc:"设置一个层为默认层"},LAUNCH_SHORTCUT:{id:"LAUNCH_SHORTCUT",name:"启动快捷方式",desc:"启动一个快捷方式(仅支持windows，使用方法见帮助)"},OPT_GROUP2:{id:"OPT_GROUP2",name:"Tap二合一功能按键 ▼",desc:"Tap二合一功能按键"},MODS_TAP_KEY:{id:"MODS_TAP_KEY",name:"按键 | 修饰键",desc:"单击时是按键，长按及和其他键组合时是修饰键"},LAYER_TAP_KEY:{id:"LAYER_TAP_KEY",name:"按键 | 瞬时开启层",desc:"单击是按键，长按及和其他键组合时是瞬时开启层"},LAYER_TAP_TOGGLE:{id:"LAYER_TAP_TOGGLE",name:"层开关 | 瞬时开启层",desc:"瞬时开启层，如果连续点击数次时开关层"},UNKNOWN:{id:"UNKNOWN",name:"其他",desc:"用于显示特殊功能，或该键盘不支持的功能"}},keycodes=(Object.freeze(action_kinds),[]),extra_keycodes=(keycodes[0]={id:"NO  ",name:'<i class="fa fa-ban fs22"></i>',desc:"设置该按键在该层无效，也可用<kt>shift</kt>+<kt>鼠标中键</kt>点击设置"},keycodes[1]={id:"TRNS",name:"",desc:"按键透明，也可用<kt>鼠标中键</kt>点击按键设置"},keycodes[2]={id:"POST_FAIL",name:"POST_FAIL",desc:"POST_FAIL"},keycodes[3]={id:"UNDEFINED",name:"UNDEFINED",desc:"UNDEFINED"},keycodes[4]={id:"A",name:"A",desc:"A"},keycodes[5]={id:"B",name:"B",desc:"B"},keycodes[6]={id:"C",name:"C",desc:"C"},keycodes[7]={id:"D",name:"D",desc:"D"},keycodes[8]={id:"E",name:"E",desc:"E"},keycodes[9]={id:"F",name:"F",desc:"F"},keycodes[10]={id:"G",name:"G",desc:"G"},keycodes[11]={id:"H",name:"H",desc:"H"},keycodes[12]={id:"I",name:"I",desc:"I"},keycodes[13]={id:"J",name:"J",desc:"J"},keycodes[14]={id:"K",name:"K",desc:"K"},keycodes[15]={id:"L",name:"L",desc:"L"},keycodes[16]={id:"M",name:"M",desc:"M"},keycodes[17]={id:"N",name:"N",desc:"N"},keycodes[18]={id:"O",name:"O",desc:"O"},keycodes[19]={id:"P",name:"P",desc:"P"},keycodes[20]={id:"Q",name:"Q",desc:"Q"},keycodes[21]={id:"R",name:"R",desc:"R"},keycodes[22]={id:"S",name:"S",desc:"S"},keycodes[23]={id:"T",name:"T",desc:"T"},keycodes[24]={id:"U",name:"U",desc:"U"},keycodes[25]={id:"V",name:"V",desc:"V"},keycodes[26]={id:"W",name:"W",desc:"W"},keycodes[27]={id:"X",name:"X",desc:"X"},keycodes[28]={id:"Y",name:"Y",desc:"Y"},keycodes[29]={id:"Z",name:"Z",desc:"Z"},keycodes[30]={id:"1",name:"!<br>1",desc:"1 !"},keycodes[31]={id:"2",name:"@<br>2",desc:"2 @"},keycodes[32]={id:"3",name:"#<br>3",desc:"3 #"},keycodes[33]={id:"4",name:"$<br>4",desc:"4 $"},keycodes[34]={id:"5",name:"%<br>5",desc:"5 %"},keycodes[35]={id:"6",name:"^<br>6",desc:"6 ^"},keycodes[36]={id:"7",name:"&<br>7",desc:"7 &"},keycodes[37]={id:"8",name:"*<br>8",desc:"8 *"},keycodes[38]={id:"9",name:"(<br>9",desc:"9 ("},keycodes[39]={id:"0",name:")<br>0",desc:"0 )"},keycodes[40]={id:"ENT",name:"Enter",desc:"Enter",name_mac:"Return",desc_mac:"Return"},keycodes[41]={id:"ESC",name:"Esc",desc:"Esc"},keycodes[42]={id:"BSPC",name:"BS",desc:"Backspace",name_mac:"Delete",desc_mac:"Delete"},keycodes[43]={id:"TAB",name:"Tab",desc:"Tab"},keycodes[44]={id:"SPC",name:"Space",desc:"Space"},keycodes[45]={id:"MINS",name:"_<br>-",desc:"- _"},keycodes[46]={id:"EQL",name:"+<br>=",desc:"= +"},keycodes[47]={id:"LBRC",name:"{<br>[",desc:"[ {"},keycodes[48]={id:"RBRC",name:"}<br>]",desc:"] }"},keycodes[49]={id:"BSLS",name:"|<br>\\",desc:"\\ |"},keycodes[50]={id:"NUHS",name:"~<br>#",desc:"ISO ~#"},keycodes[51]={id:"SCLN",name:":<br>;",desc:"; :"},keycodes[52]={id:"QUOT",name:"\"<br>'",desc:"' \""},keycodes[53]={id:"GRV ",name:"~<br>`",desc:"` ~"},keycodes[54]={id:"COMM",name:"<<br>,",desc:", <"},keycodes[55]={id:"DOT ",name:"><br>.",desc:". >"},keycodes[56]={id:"SLSH",name:"?<br>/",desc:"/ ?"},keycodes[57]={id:"CAPS",name:"Caps Lock",desc:"CapsLock"},keycodes[58]={id:"F1  ",name:"F1",desc:"F1"},keycodes[59]={id:"F2  ",name:"F2",desc:"F2"},keycodes[60]={id:"F3  ",name:"F3",desc:"F3"},keycodes[61]={id:"F4  ",name:"F4",desc:"F4"},keycodes[62]={id:"F5  ",name:"F5",desc:"F5"},keycodes[63]={id:"F6  ",name:"F6",desc:"F6"},keycodes[64]={id:"F7  ",name:"F7",desc:"F7"},keycodes[65]={id:"F8  ",name:"F8",desc:"F8"},keycodes[66]={id:"F9  ",name:"F9",desc:"F9"},keycodes[67]={id:"F10 ",name:"F10",desc:"F10"},keycodes[68]={id:"F11 ",name:"F11",desc:"F11"},keycodes[69]={id:"F12 ",name:"F12",desc:"F12"},keycodes[70]={id:"PSCR",name:"Print<br>Scrn",desc:"Print Screen",name_mac:"F13",desc_mac:"F13(mac)"},keycodes[71]={id:"SLCK",name:"Scrll<br>Lock",desc:"Scroll Lock",name_mac:"F14",desc_mac:"F14(mac)"},keycodes[72]={id:"PAUS",name:"Pause",desc:"Pause Break",name_mac:"F15",desc_mac:"F15(mac)"},keycodes[73]={id:"INS ",name:"Ins",desc:"Insert"},keycodes[74]={id:"HOME",name:"Home",desc:"Home"},keycodes[75]={id:"PGUP",name:"Page<br>Up",desc:"Page Up"},keycodes[76]={id:"DEL ",name:"Del",desc:"Del"},keycodes[77]={id:"END ",name:"End",desc:"End"},keycodes[78]={id:"PGDN",name:"Page<br>Dn",desc:"Page Down"},keycodes[79]={id:"RGHT",name:"→",name_dsa:'<i class="fa fa-arrow-right"/>',desc:"Right"},keycodes[80]={id:"LEFT",name:"←",name_dsa:'<i class="fa fa-arrow-left"/>',desc:"Left"},keycodes[81]={id:"DOWN",name:"↓",name_dsa:'<i class="fa fa-arrow-down"/>',desc:"Down"},keycodes[82]={id:"UP  ",name:"↑",name_dsa:'<i class="fa fa-arrow-up"/>',desc:"Up"},keycodes[83]={id:"NLCK",name:"Num<br>Lock",desc:"Num Lock",name_mac:"Clear",desc_mac:"Clear"},keycodes[84]={id:"PSLS",name:"/",name_dsa:"÷",desc:"Keypad /"},keycodes[85]={id:"PAST",name:"*",name_dsa:"×",desc:"Keypad *"},keycodes[86]={id:"PMNS",name:"-",desc:"Keypad -"},keycodes[87]={id:"PPLS",name:"+",desc:"Keypad +"},keycodes[88]={id:"PENT",name:"P↩",desc:"Keypad Enter"},keycodes[89]={id:"P1  ",name:'1<br><span class="fs10">End</span>',name_dsa:"1",desc:"Keypad 1"},keycodes[90]={id:"P2  ",name:"2<br>↓",name_dsa:"2",desc:"Keypad 2"},keycodes[91]={id:"P3  ",name:'3<br><span class="fs10">PgDn</span>',name_dsa:"3",desc:"Keypad 3"},keycodes[92]={id:"P4  ",name:"4<br>←",name_dsa:"4",desc:"Keypad 4"},keycodes[93]={id:"P5  ",name:"5",desc:"Keypad 5"},keycodes[94]={id:"P6  ",name:"6<br>→",name_dsa:"6",desc:"Keypad 6"},keycodes[95]={id:"P7  ",name:'7<br><span class="fs10">Home</span>',name_dsa:"7",desc:"Keypad 7"},keycodes[96]={id:"P8  ",name:"8<br>↑",name_dsa:"8",desc:"Keypad 8"},keycodes[97]={id:"P9  ",name:'9<br><span class="fs10">PgUp</span>',name_dsa:"9",desc:"Keypad 9"},keycodes[98]={id:"P0  ",name:'0<br><span class="fs10">Ins</span>',name_dsa:"0",desc:"Keypad 0"},keycodes[99]={id:"PDOT",name:'.<br><span class="fs10">Del</span>',name_dsa:".",desc:"Keypad ."},keycodes[100]={id:"NUBS",name:"|<sub>ISO</sub><br>\\",desc:"|\\ for ISO layout"},keycodes[101]={id:"APP ",name:"Menu",desc:"Menu on Win"},keycodes[102]={id:"POWER",name:"Power",desc:"Power(work on Mac)"},keycodes[103]={id:"PEQL",name:"=",desc:"Keymapd Equal(Not work on Win)"},keycodes[104]={id:"F13 ",name:"F13",desc:"F13"},keycodes[105]={id:"F14 ",name:"F14",desc:"F14"},keycodes[106]={id:"F15 ",name:"F15",desc:"F15"},keycodes[107]={id:"F16 ",name:"F16",desc:"F16"},keycodes[108]={id:"F17 ",name:"F17",desc:"F17"},keycodes[109]={id:"F18 ",name:"F18",desc:"F18"},keycodes[110]={id:"F19 ",name:"F19",desc:"F19"},keycodes[111]={id:"F20 ",name:"F20",desc:"F20"},keycodes[112]={id:"F21 ",name:"F21",desc:"F21"},keycodes[113]={id:"F22 ",name:"F22",desc:"F22"},keycodes[114]={id:"F23 ",name:"F23",desc:"F23"},keycodes[115]={id:"F24 ",name:"F24",desc:"F24"},keycodes[130]={id:"LCAP",name:"Locking Caps Lock",desc:"Locking Caps Lock"},keycodes[131]={id:"LNUM",name:"Locking Num Lock",desc:"Locking Num Lock"},keycodes[132]={id:"LSCR",name:"Locking Scroll Lock",desc:"Locking Scroll Lock"},keycodes[135]={id:"INT1",name:"JIS ろ",desc:"Japanese RO"},keycodes[136]={id:"INT2",name:"ひらがな",desc:"Japanese Hiragana"},keycodes[137]={id:"INT3",name:"JIS ￥",desc:"Japanese Yen"},keycodes[138]={id:"INT4",name:"変換",desc:"Japanese Henkan"},keycodes[139]={id:"INT5",name:"無変換",desc:"Japanese Muhenkan"},keycodes[140]={id:"INT6",name:"INT6",desc:"INT6"},keycodes[141]={id:"INT7",name:"INT7",desc:"INT7"},keycodes[142]={id:"INT8",name:"INT8",desc:"INT8"},keycodes[143]={id:"INT9",name:"INT9",desc:"INT9"},keycodes[144]={id:"LANG1",name:"한/영",desc:"Korean Hangul/English"},keycodes[145]={id:"LANG2",name:"한자",desc:"Korean Hanja"},keycodes[146]={id:"LANG3",name:"LANG3",desc:"LANG3"},keycodes[147]={id:"LANG4",name:"LANG4",desc:"LANG4"},keycodes[148]={id:"LANG5",name:"LANG5",desc:"LANG5"},keycodes[149]={id:"LANG6",name:"LANG6",desc:"LANG6"},keycodes[150]={id:"LANG7",name:"LANG7",desc:"LANG7"},keycodes[151]={id:"LANG8",name:"LANG8",desc:"LANG8"},keycodes[152]={id:"LANG9",name:"LANG9",desc:"LANG9"},keycodes[176]={id:"P00",name:"00",desc:"Keypad 00, 极少数键盘未支持此功能"},keycodes[224]={id:"LCTL",name:"Ctrl",desc:"Left Control"},keycodes[225]={id:"LSFT",name:"Shift",desc:"Left Shift"},keycodes[226]={id:"LALT",name:"Alt",desc:"Left Alt",name_mac:"Option",desc_mac:"Left option⌥"},keycodes[227]={id:"LGUI",name:"Win",desc:"Left Windows",name_mac:"Cmd⌘",desc_mac:"Left command⌘"},keycodes[228]={id:"RCTL",name:"rCtrl",desc:"Right Control"},keycodes[229]={id:"RSFT",name:"rShift",desc:"Right Shift"},keycodes[230]={id:"RALT",name:"rAlt",desc:"Right Alt",name_mac:"rOption",desc_mac:"Right option⌥"},keycodes[231]={id:"RGUI",name:"rWin",desc:"Right Windows",name_mac:"rCmd⌘",desc_mac:"Right command⌘"},Object.freeze(keycodes),{358:{id:"MAC_POWER_MENU",name:'<i class="i_mac_powermenu fs32"></i>',desc:"Mac: 显示一个对话框，询问您是要重新启动、睡眠还是关机"},870:{id:"MAC_SCREENOFF",name:'<i class="i_mac_display_off fs32"></i>',desc:"Mac: 将显示器置于睡眠状态"},3174:{id:"MAC_SLEEP",name:'<i class="i_mac_powersleep fs32"></i>',desc:"Mac: 将您的 Mac 置于睡眠状态"}});function keyCode2tmkCode(e){return{8:42,9:43,13:40,272:225,528:229,273:224,529:228,274:226,530:230,19:72,20:57,27:41,32:44,33:75,34:78,35:77,36:74,37:80,38:82,39:79,40:81,44:70,45:73,46:76,48:39,49:30,50:31,51:32,52:33,53:34,54:35,55:36,56:37,57:38,65:4,66:5,67:6,68:7,69:8,70:9,71:10,72:11,73:12,74:13,75:14,76:15,77:16,78:17,79:18,80:19,81:20,82:21,83:22,84:23,85:24,86:25,87:26,88:27,89:28,90:29,347:227,604:231,605:231,93:101,781:88,864:98,813:98,865:89,803:89,866:90,808:90,867:91,802:91,868:92,805:92,869:93,780:93,870:94,807:94,871:95,804:95,872:96,806:96,873:97,801:97,874:85,875:87,877:86,878:99,814:99,879:84,112:58,113:59,114:60,115:61,116:62,117:63,118:64,119:65,120:66,121:67,122:68,123:69,144:83,145:71,186:51,187:46,188:54,189:45,190:55,191:56,192:53,219:47,220:49,221:48,222:52,124:104,173:16610,174:16618,175:16617,183:16786,226:100}[e]}function keyName2tmkCode(e){return keyUnimap={KANA:"00",VOLDN:"40EA",VOLUP:"40E9",MUTE:"40E2",CALC:"4192",A:"04",B:"05",C:"06",D:"07",E:"08",F:"09",G:"0A",H:"0B",I:"0C",J:"0D",K:"0E",L:"0F",M:"10",N:"11",O:"12",P:"13",Q:"14",R:"15",S:"16",T:"17",U:"18",V:"19",W:"1A",X:"1B",Y:"1C",Z:"1D",1:"1E",2:"1F",3:"20",4:"21",5:"22",6:"23",7:"24",8:"25",9:"26",0:"27",ENTER:"28",ESC:"29",BS:"2A",BACKSPACE:"2A",TAB:"2B",SPACE:"2C","-":"2D","=":"2E","[":"2F","]":"30","\\":"31","ISO#":"32",";":"33","'":"34","`":"35",",":"36",".":"37","/":"38",CAPSLOCK:"39","CAPS LOCK":"39",F1:"3A",F2:"3B",F3:"3C",F4:"3D",F5:"3E",F6:"3F",F7:"40",F8:"41",F9:"42",F10:"43",F11:"44",F12:"45",PRTSCR:"46","PRINT SCREEN":"46",SCRLK:"47","SCROLL LOCK":"47",PAUSE:"48","PAUSE BREAK":"48",INS:"49",INSERT:"49",HOME:"4A",PGUP:"4B","PAGE UP":"4B",DEL:"4C",DELETE:"4C",END:"4D",PGDN:"4E","PAGE DOWN":"4E",RIGHT:"4F",LEFT:"50",DOWN:"51",UP:"52","NUM LOCK":"53",NUMLK:"53",NUMLOCK:"53","P/":"54","P*":"55","P-":"56","P+":"57",PENTER:"58",P1:"59",P2:"5A",P3:"5B",P4:"5C",P5:"5D",P6:"5E",P7:"5F",P8:"60",P9:"61",P0:"62","P.":"63","ISO\\":"64",MENU:"65","P,":"66","P=":"67",F13:"68",F14:"69",F15:"6A",F16:"6B",F17:"6C",F18:"6D",F19:"6E",F20:"6F",F21:"70",F22:"71",F23:"72",F24:"73",JYEN:"74",RO:"75",HENK:"76",MHEN:"77",CTRL:"78",SHIFT:"79",ALT:"7A",WIN:"7B",RCTRL:"7C",RSHIFT:"7D",RALT:"7E",RWIN:"7F",NO:"80"},keyUnimap[e]}function tmkCode2keyName(e){return keyName={0:"Kana",1:" ",2:" ",3:" ",4:"A",5:"B",6:"C",7:"D",8:"E",9:"F",10:"G",11:"H",12:"I",13:"J",14:"K",15:"L",16:"M",17:"N",18:"O",19:"P",20:"Q",21:"R",22:"S",23:"T",24:"U",25:"V",26:"W",27:"X",28:"Y",29:"Z",30:"1",31:"2",32:"3",33:"4",34:"5",35:"6",36:"7",37:"8",38:"9",39:"0",40:"Enter",41:"Esc",42:"Backspace",43:"Tab",44:"Space",45:"Minus",46:"Equal",47:"LeftBracket",48:"RightBracket",49:"BackSlash",50:"iso#",51:"Semicolon",52:"Quote",53:"Grave",54:"Comma",55:"Dot",56:"Slash",57:"Capslock",58:"F1",59:"F2",60:"F3",61:"F4",62:"F5",63:"F6",64:"F7",65:"F8",66:"F9",67:"F10",68:"F11",69:"F12",70:"PrtScr",71:"ScrLk",72:"Pause",73:"Insert",74:"Home",75:"PgUp",76:"Delete",77:"End",78:"PgDn",79:"Right",80:"Left",81:"Down",82:"Up",83:"Numlock",84:"PSlash",85:"PAster",86:"PMinus",87:"PPlus",88:"PEnter",89:"P1",90:"P2",91:"P3",92:"P4",93:"P5",94:"P6",95:"P7",96:"P8",97:"P9",98:"P0",99:"PDot",100:"iso\\",101:"Menu",102:"P,",103:"P=",104:"F13",105:"F14",106:"F15",107:"F16",108:"F17",109:"F18",110:"F19",111:"F20",112:"F21",113:"F22",114:"F23",115:"F24",116:"Jyen",117:"Ro",118:"Henk",119:"Mhen",120:"Ctrl",121:"Shift",122:"Alt",123:"Win",124:"RCtrl",125:"RShift",126:"RAlt",127:"RWin",128:"No",224:"Ctrl",225:"Shift",226:"Alt",227:"Win",228:"RCtrl",229:"RShift",230:"RAlt",231:"RWin",16618:"Voldn",16617:"VolUp",16610:"Mute",16786:"Calc"},keyName[e]}function shorten_date(e){e=parseInt(e,10);return e<10?""+e:String.fromCharCode(e+55)}function keylabel_mac(e){return e.desc=e.desc.replace("Alt","Option").replace(/Windows|Win|Gui/g,"Command").replace("Backspace","Delete").replace("Keypad Enter","PENT").replace("Enter","Return").replace("PENT","Keypad Enter").replace("Num Lock","Clear").replace("Insert","help").replace("Print Screen","F13(Mac)").replace("Scroll Lock","F14(Mac)").replace("Pause Break","F15(Mac)"),e.name=e.name.replace(/backspace|bs/i,"delete").replace(/caps lock/i,"caps<br>lock").replace(/enter/i,"return").replace(/ctrl/i,"control").replace(/short_ctl/i,"ctrl").replace(/alt/i,"option").replace(/win/i,"cmd⌘").replace(/print<br>scrn/i,"F13").replace(/scrll<br>lock/i,"F14").replace(/pause/i,"F15").replace(/ins/i,"help").replace(/p↩/i,"enter").replace(/p=/i,"=").replace(/num<br>lock/i,"clear"),e}function source_output(e){var a,t="",t=(t=(t=(t=(t+='#include "action.h"\n')+'#include "action_code.h"\n'+'#include "actionmap.h"\n')+"\n"+"const action_t actionmaps[][")+e[0].length+"][")+e[0][0].length+'] __attribute__ ((section (".keymap.keymaps"))) = {\n';for(a in e){for(var s in t+="    {\n",e[a]){for(var o in t+="        { ",e[a][s])t=t+("0x"+("000"+e[a][s][o].toString(16)).substr(-4))+",";t+=" },\n"}t+="    },\n"}return t+="};\n"}function hex_line(e,a,t){function s(e){return("0"+e.toString(16)).substr(-2).toUpperCase()}for(var o=0,n=(o=(o=o+t.length+(e>>8))+(255&e)+a,":"),n=(n=(n=(n+=s(t.length))+s(e>>8))+s(255&e))+s(a),d=0;d<t.length;d++)o+=t[d],n+=s(t[d]);return n+=s(1+~o&255)}function hex_eof(){return":00000001FF"}function hex_output(a,e){var t=[],s=[];return[].concat.apply([],[].concat.apply([],e)).forEach(function(e){s.push(e),16==s.length&&(t.push(hex_line(a,0,s)),a+=16,s.length=0)}),0<s.length&&(t+=hex_line(a,0,s)),t}function hex_keymaps(e){var a=[];return a=(a=[].concat.apply([],[].concat.apply([],keymaps))).map(function(e){return[255&e,(65280&e)>>8]}),hex_output(e,a=[].concat.apply([],a))}function get_fw_date_from_hex(e){for(var a=convert_hex2bin([].concat(e),0,KEYMAP_START_ADDRESS),t=new Array(0,0,0),s=0;s<a.length;s++)if(85==a[s]&&0==a[++s]&&83==a[++s]&&0==a[++s]&&66==a[++s]&&0==a[++s]&&95==a[++s]&&0==a[++s]&&68==a[++s]){console.log("find USB_D"),t[0]=a[s+2]-55,month_day_to_num=function(e){return e<=57?e-48:65<=e?e-55:void 0},t[1]=month_day_to_num(a[s+4]),t[2]=month_day_to_num(a[s+6]);break}return 19<=t[0]&&0<t[1]&&t[1]<=12&&0<t[2]&&t[2]<=31?t:0}function hex_split_firmware(l,e,_){for(var a=[],t=[],s=[],o=a,n=0,m=l.split("\n"),d=0;d<m.length;d++){var i=m[d].trim();if(":020000040800F2"!=i){if(":"!=i.substring(0,1))break;var u=parseInt(i.substring(1,3),16),p=parseInt(i.substring(3,7),16),y=i.substring(7,9);if("00"==y)if(p+n<e)a.push(i),o=a;else if(e+_<=p+n)t.push(i),o=t;else for(var h=0,c=0;c<u;c++)c%2==1?s.push(parseInt(i.substring(9+2*c,11+2*c),16)<<8|h):h=parseInt(i.substring(9+2*c,11+2*c),16);else"04"==y?(0==a.length?o=a:e+_<=(n=65536*parseInt(i.substring(9,13),16))&&(o=t),o.push(i)):("01"==y?t:o).push(i)}}for(var f=[],r=[];0<s.length;)r.push(s.splice(0,16)),8==r.length&&(f.push(r),r=[]);return{before:a,after:t,keymaps:f,date:get_fw_date_from_hex(a)}}function bin_split_firmware(e,a,t,s){var l=[],o=[],n=[],d=(null!=s&&(a-=s),console.log(a),new Uint8Array(e.length));d.fill(255);for(var i=0;i<e.length;i++)d[i]=parseInt(e[i].charCodeAt(0),10);for(i=a;i<a+t;i++)n.push(d[i]|d[i+1]<<8),i++;for(i=a+t;i<e.length;i++)o[i-a-t]=d[i];for(var c=[],r=[];0<n.length;)r.push(n.splice(0,16)),8==r.length&&(c.push(r),r=[]);return{before:l,after:o,keymaps:c}}function url_encode_keymap(e){return"undefined"!=typeof LZString&&"undefined"!=typeof Base64?Base64.encode(LZString.compress(JSON.stringify(e))):window.btoa(JSON.stringify(e))}function url_decode_keymap(e){if(null==e||"string"!=typeof e||e.length<30)return null;var a=unzip(e);if(null!=a)return console.log("zip"),JSON.parse(a);try{return"undefined"!=typeof LZString&&"undefined"!=typeof Base64?(console.log("lz"),JSON.parse(LZString.decompress(Base64.decode(e))).keymaps):JSON.parse(window.atob(e)).keymaps}catch(e){return null}}function unzip(e){e=atob(e);return pako.ungzip(e,{to:"string"})}function zip(e){e=pako.gzip(e,{to:"string"});return btoa(e)}function bin_to_uf2(e,a,t){for(var s=e.length+255>>8,o=[],n=0;n<e.length;n+=256){for(var d=new ArrayBuffer(512),i=new DataView(d),c=0;c<512;c++)i[c]=0;i.setUint32(0,171066965,!0),i.setUint32(4,2656915799,!0),i.setUint32(8,8192,!0),i.setUint32(12,a+n,!0),i.setUint32(16,256,!0),i.setUint32(20,o.length/512,!0),i.setUint32(24,s,!0),i.setUint32(28,t,!0);for(c=0;c<256;++c)i.setUint8(c+32,e[n+c]);i.setUint32(508,179400496,!0);for(c=0;c<512;c++)o.push(i.getUint8(c))}return new Uint8Array(o)}function uf2_to_bin(e){for(var a="",t=parseInt(e[13].charCodeAt(0),10)<<8|parseInt(e[12].charCodeAt(0),10),s=0;s<e.length;s+=512)for(var o=0;o<512;o++)32<=o&&o<288&&(a+=e[o+s]);return{binstr:a,bin_start_addr:t}}function load_hex_uf2(e){fetch(e).then(checkResponse).then(parseTEXT).then(function(e){e=hex_split_firmware(e,63488,KEYMAP_SIZE);firmware_before_uf2=e.before})}system_codes=[],system_codes[129]={id:"PWR ",name:'<i class="i_system_power fs32"></i>',desc:"System Power，适合Win10，仅有线模式下有效"},system_codes[130]={id:"SLEP",name:'<i class="i_system_sleep fs32"></i>',desc:"System Sleep，仅有线模式下有效"},system_codes[131]={id:"WAKE",name:'<i class="i_system_wake fs32"></i>',desc:"System Wake，仅有线模式下有效"},Object.freeze(system_codes),consumer_codes={111:{id:"SBUP",name:' <i style="padding-left:6px" class="kb kb-Unicode-Screen-Bright fs24"/>',desc:"增大屏幕亮度，需要设备本身支持此功能，系统要求win8以上/Mac/iOS/iPadOS"},112:{id:"SBDN",name:' <i style="padding-left:6px" class="kb kb-Unicode-Screen-Dim fs24"/>',desc:"降低屏幕亮度，需要设备本身支持此功能，系统要求win8以上/Mac/iOS/iPadOS"},226:{id:"MUTE",name:' <i class="kb kb-Multimedia-Mute-2 fs22"/>',desc:"静音"},233:{id:"VOLU",name:' <i class="kb kb-Multimedia-Volume-Up-2 fs22"/>',desc:"音量加"},234:{id:"VOLD",name:' <i class="kb kb-Multimedia-Volume-Down-2 fs22"/>',desc:"音量减"},181:{id:"MNXT",name:' <i class="fa fa-step-forward fs20"/>',desc:"下一曲"},182:{id:"MPRV",name:' <i class="fa fa-step-backward fs20"/>',desc:"上一曲"},183:{id:"MSTP",name:' <i class="fa fa-stop fs20"/>',desc:"停止播放"},184:{id:"EJCT",name:' <i class="material-icons fs22">keyboard_hide</i>',desc:"显示或隐藏iOS/iPadOS虚拟键盘"},205:{id:"MPLY",name:' <i class="fa fa-play fs20"/>',desc:"播放/暂停"},387:{id:"MSEL",name:' <i class="fa fa-music fs20"/>',desc:"启动默认音乐播放器"},394:{id:"MAIL",name:' <i class="fa fa-envelope fs20"></i>',desc:"邮件"},402:{id:"CALC",name:' <i class="fa fa-calculator fs22"/>',desc:"计算器，仅Windows下有效"},404:{id:"MYCM",name:' <i class="fa fa-desktop fs20"></i>',desc:"资源管理器，仅Windows下有效"},545:{id:"WSCH",name:'<i class="i_www_search fs32"></i>',desc:"浏览器： 搜索"},547:{id:"WHOM",name:'<i class="i_www_home fs32"></i>',desc:"浏览器： 主页"},548:{id:"WBAK",name:'<i class="i_www_back fs32"></i>',desc:"浏览器： 后退"},549:{id:"WFWD",name:'<i class="i_www_forward fs32"></i>',desc:"浏览器： 前进"},550:{id:"WSTP",name:'<i class="i_www_stop fs32"></i>',desc:"浏览器： 停止"},551:{id:"WREF",name:'<i class="i_www_refresh fs32"></i>',desc:"浏览器： 刷新"},554:{id:"WFAV",name:'<i class="i_www_favorites fs32"></i>',desc:"浏览器： 收藏夹"},179:{id:"MFFD",name:"Fast Forward",desc:"Media Fast Forward(Mac)"},180:{id:"MRWD",name:"Rewind",desc:"Media Rewind(Mac)"}},Object.freeze(consumer_codes),mousekey_codes=[],mousekey_codes[240]={id:"MS_U",name:'<i class="i_mouse_move_up fs32"></i>',desc:"鼠标： 上移"},mousekey_codes[241]={id:"MS_D",name:'<i class="i_mouse_move_down fs32"></i>',desc:"鼠标： 下移"},mousekey_codes[242]={id:"MS_L",name:'<i class="i_mouse_move_left fs32"></i>',desc:"鼠标： 左移"},mousekey_codes[243]={id:"MS_R",name:'<i class="i_mouse_move_right fs32"></i>',desc:"鼠标： 右移"},mousekey_codes[244]={id:"BTN1",name:'<i class="i_mouse_left fs32"></i>',desc:"鼠标: 点击左键"},mousekey_codes[245]={id:"BTN2",name:'<i class="i_mouse_right fs32"></i>',desc:"鼠标: 点击右键"},mousekey_codes[246]={id:"BTN3",name:'<i class="i_mouse_middle fs32"></i>',desc:"鼠标: 点击中键"},mousekey_codes[247]={id:"BTN4",name:'<i class="i_mouse_back fs32"></i>',desc:"鼠标: 点击后退"},mousekey_codes[248]={id:"BTN5",name:'<i class="i_mouse_forward fs32"></i>',desc:"鼠标: 点击前进"},mousekey_codes[249]={id:"WH_U",name:'<i class="i_mouse_wheel_up fs32"></i>',desc:"鼠标: 滚轮 上"},mousekey_codes[250]={id:"WH_D",name:'<i class="i_mouse_wheel_down fs32"></i>',desc:"鼠标: 滚轮 下"},mousekey_codes[251]={id:"WH_L",name:'<i class="i_mouse_wheel_left fs32"></i>',desc:"鼠标: 滚轮 左"},mousekey_codes[252]={id:"WH_R",name:'<i class="i_mouse_wheel_right fs32"></i>',desc:"鼠标: 滚轮 右"},mousekey_codes[253]={id:"ACL0",name:'<i class="i_mouse_speed_slow fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"慢速"匀速移动'},mousekey_codes[254]={id:"ACL1",name:'<i class="i_mouse_speed_medium fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"中速"匀速移动'},mousekey_codes[255]={id:"ACL2",name:'<i class="i_mouse_speed_fast fs32"></i>',desc:'按住此键，再按鼠标移动键时，鼠标指针"快速"匀速移动'},mousekey_codes[0]={id:"BTN1_",name:"火力左键",desc:"火力模式按键 鼠标左键"},mousekey_codes[4]={id:"A",name:"火A",desc:"火力模式按键 A"},mousekey_codes[5]={id:"B",name:"火B",desc:"火力模式按键 B"},mousekey_codes[6]={id:"C",name:"火C",desc:"火力模式按键 C"},mousekey_codes[7]={id:"D",name:"火D",desc:"火力模式按键 D"},mousekey_codes[8]={id:"E",name:"火E",desc:"火力模式按键 E"},mousekey_codes[9]={id:"F",name:"火F",desc:"火力模式按键 F"},mousekey_codes[10]={id:"G",name:"火G",desc:"火力模式按键 G"},mousekey_codes[11]={id:"H",name:"火H",desc:"火力模式按键 H"},mousekey_codes[12]={id:"I",name:"火I",desc:"火力模式按键 I"},mousekey_codes[13]={id:"J",name:"火J",desc:"火力模式按键 J"},mousekey_codes[14]={id:"K",name:"火K",desc:"火力模式按键 K"},mousekey_codes[15]={id:"L",name:"火L",desc:"火力模式按键 L"},mousekey_codes[16]={id:"M",name:"火M",desc:"火力模式按键 M"},mousekey_codes[17]={id:"N",name:"火N",desc:"火力模式按键 N"},mousekey_codes[18]={id:"O",name:"火O",desc:"火力模式按键 O"},mousekey_codes[19]={id:"P",name:"火P",desc:"火力模式按键 P"},mousekey_codes[20]={id:"Q",name:"火Q",desc:"火力模式按键 Q"},mousekey_codes[21]={id:"R",name:"火R",desc:"火力模式按键 R"},mousekey_codes[22]={id:"S",name:"火S",desc:"火力模式按键 S"},mousekey_codes[23]={id:"T",name:"火T",desc:"火力模式按键 T"},mousekey_codes[24]={id:"U",name:"火U",desc:"火力模式按键 U"},mousekey_codes[25]={id:"V",name:"火V",desc:"火力模式按键 V"},mousekey_codes[26]={id:"W",name:"火W",desc:"火力模式按键 W"},mousekey_codes[27]={id:"X",name:"火X",desc:"火力模式按键 X"},mousekey_codes[28]={id:"Y",name:"火Y",desc:"火力模式按键 Y"},mousekey_codes[29]={id:"Z",name:"火Z",desc:"火力模式按键 Z"},mousekey_codes[30]={id:"1",name:"火1",desc:"火力模式按键 1 !"},mousekey_codes[31]={id:"2",name:"火2",desc:"火力模式按键 2 @"},mousekey_codes[32]={id:"3",name:"火3",desc:"火力模式按键 3 #"},mousekey_codes[33]={id:"4",name:"火4",desc:"火力模式按键 4 $"},mousekey_codes[34]={id:"5",name:"火5",desc:"火力模式按键 5 %"},mousekey_codes[35]={id:"6",name:"火6",desc:"火力模式按键 6 ^"},mousekey_codes[36]={id:"7",name:"火7",desc:"火力模式按键 7 &"},mousekey_codes[37]={id:"8",name:"火8",desc:"火力模式按键 8 *"},mousekey_codes[38]={id:"9",name:"火9",desc:"火力模式按键 9 ("},mousekey_codes[39]={id:"0",name:"火0",desc:"火力模式按键 0 )"},mousekey_codes[62]={id:"F5",name:"火F5",desc:"火力模式按键 F5"},Object.freeze(mousekey_codes),mods_codes=[],mods_codes[0]={id:0,name:"    ",desc:"none"},mods_codes[1]={id:1,name:"Ctrl",desc:"Control"},mods_codes[2]={id:2,name:"Shift",desc:"Shift"},mods_codes[3]={id:3,name:"Shift+Ctrl",desc:"Shift + Control"},mods_codes[4]={id:4,name:"Alt",desc:"Alt"},mods_codes[5]={id:5,name:"Alt+Ctrl",desc:"Alt + Control"},mods_codes[6]={id:6,name:"Alt+Shift",desc:"Alt + Shift"},mods_codes[7]={id:7,name:"Alt+Shift+Ctrl",desc:"Alt + Shift + Control"},mods_codes[8]={id:8,name:"Win",desc:"Win"},mods_codes[9]={id:9,name:"Win+Ctrl",desc:"Win + Control"},mods_codes[10]={id:10,name:"Win+Shift",desc:"Win + Shift"},mods_codes[11]={id:11,name:"Win+Shift+Ctrl",desc:"Win + Shift + Control"},mods_codes[12]={id:12,name:"Win+Alt",desc:"Win + Alt"},mods_codes[13]={id:13,name:"Win+Alt+Ctrl",desc:"Win + Alt + Control"},mods_codes[14]={id:14,name:"Win+Alt+Shift",desc:"Win + Alt + Shift"},mods_codes[15]={id:15,name:"Win+Alt+Shift+Ctrl",desc:"Win + Alt + Shift + Control"},mods_codes[16]={id:16,name:"    ",desc:"none"},mods_codes[17]={id:17,name:"rCtrl",desc:"rControl"},mods_codes[18]={id:18,name:"rShift",desc:"rShift"},mods_codes[19]={id:19,name:"rShift+rCtrl",desc:"rShift + rControl"},mods_codes[20]={id:20,name:"rAlt",desc:"rAlt"},mods_codes[21]={id:21,name:"rAlt+rCtrl",desc:"rAlt + rControl"},mods_codes[22]={id:22,name:"rAlt+rShift",desc:"rAlt + rShift"},mods_codes[23]={id:23,name:"rAlt+rShift+rCtrl",desc:"rAlt + rShift + rControl"},mods_codes[24]={id:24,name:"rWin",desc:"rWin"},mods_codes[25]={id:25,name:"rWin+rCtrl",desc:"rWin + rControl"},mods_codes[26]={id:26,name:"rWin+rShift",desc:"rWin + rShift"},mods_codes[27]={id:27,name:"rWin+rShift+rCtrl",desc:"rWin + rShift + rControl"},mods_codes[28]={id:28,name:"rWin+rAlt",desc:"rWin + rAlt"},mods_codes[29]={id:29,name:"rWin+rAlt+rCtrl",desc:"rWin + rAlt + rControl"},mods_codes[30]={id:30,name:"rWin+rAlt+rShift",desc:"rWin + rAlt + rShift"},mods_codes[31]={id:31,name:"rWin+rAlt+rShift+rCtrl",desc:"rWin + rAlt + rShift + rControl"},Object.freeze(mods_codes),on_codes=[],on_codes[1]={id:1,name:"On Press",desc:"On Press"},on_codes[2]={id:1,name:"On Release",desc:"On Release"},on_codes[3]={id:1,name:"On Both",desc:"On Press and Release"},am_codes=[],am_codes[0]={id:"未知",name:"未知",desc:"未知"},af_codes=[],af_codes[0]={id:"未知",name:"未知",desc:"未知"},KEYMAP_ROW=KEYMAP_LAYERS=8,KEYMAP_COL=16,no_map=function(){return new Array(8).fill(0).map(e=>new Array(16).fill(0))},transparent_map=function(){return new Array(8).fill(1).map(e=>new Array(16).fill(1))},keymaps=[[[136,17642,17641,17634,4,5,6,7,8,9,10,11,12,13,14,15],[16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],[32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47],[48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],[64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79],[80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95],[96,97,98,99,100,101,133,103,20724,20725,20726,20727,20728,20729,20730,111],[112,113,114,115,137,135,138,139,224,225,226,227,228,229,230,231]],transparent_map(),transparent_map(),transparent_map(),transparent_map(),transparent_map(),transparent_map(),transparent_map()],KEYMAP_START_ADDRESS=26624,KEYMAP_SIZE=2048,ACT_MODS=0,ACT_LMODS=0,ACT_RMODS=1,ACT_MODS_TAP=2,ACT_LMODS_TAP=2,ACT_RMODS_TAP=3,ACT_USAGE=4,ACT_MOUSEKEY=5,ACT_LAYER=8,ACT_LAYER_EXT=9,ACT_LAYER_TAP=10,ACT_LAYER_TAP_EXT=11,ACT_MACRO=12,ACT_BACKLIGHT=13,ACT_COMMAND=14,ACT_FUNCTION=15,OP_TAP_TOGGLE=240,OP_ON_OFF=241,OP_OFF_ON=242,OP_SET_CLEAR=243,OP_BIT_AND=0,OP_BIT_OR=1,OP_BIT_XOR=2,OP_BIT_SET=3,ON_SPECIAL_USE=0,ON_BOTH=3,MOD_LCTL=ON_PRESS=1,MOD_LSFT=ON_RELEASE=2,MOD_LALT=4,MOD_LGUI=8,MOD_RCTL=17,MOD_RSFT=18,MOD_RALT=20,MOD_RGUI=24,MODS_ONESHOT=0,MODS_TAP_TOGGLE=1,PAGE_CONSUMER=0,PAGE_SYSTEM=1,FUNC_TAP=8;var kind_codes={KEY:ACT_MODS<<12,MODS_KEY:ACT_MODS<<12,MODS_TAP_KEY:ACT_MODS_TAP<<12,MODS_ONESHOT:ACT_MODS_TAP<<12|MODS_ONESHOT,MODS_TAP_TOGGLE:ACT_MODS_TAP<<12|MODS_TAP_TOGGLE,USAGE_SYSTEM:ACT_USAGE<<12|PAGE_SYSTEM<<10,USAGE_CONSUMER:ACT_USAGE<<12|PAGE_CONSUMER<<10,MOUSEKEY:ACT_MOUSEKEY<<12,MACRO:ACT_MACRO<<12,MACRO_TAP:ACT_MACRO<<12,MACRO_OPT:ACT_MACRO<<12,FUNCTION:ACT_FUNCTION<<12,FUNCTION_TAP:ACT_FUNCTION<<12|FUNC_TAP<<8,FUNCTION_OPT:ACT_FUNCTION<<12,LAYER_CLEAR:ACT_LAYER<<12|OP_BIT_AND<<10,LAYER_MOMENTARY:ACT_LAYER_TAP<<12|OP_ON_OFF,LAYER_TOGGLE:ACT_LAYER<<12|OP_BIT_XOR<<10|ON_RELEASE<<8,LAYER_INVERT:ACT_LAYER<<12|OP_BIT_XOR<<10,LAYER_ON:ACT_LAYER<<12|OP_BIT_OR<<10,LAYER_OFF:ACT_LAYER<<12|OP_BIT_AND<<10,LAYER_SET:ACT_LAYER<<12|OP_BIT_SET<<10,LAYER_TAP_KEY:ACT_LAYER_TAP<<12,LAYER_MODS:ACT_LAYER_TAP<<12|224,LAYER_TAP_TOGGLE:ACT_LAYER_TAP<<12|OP_TAP_TOGGLE,LAYER_ON_OFF:ACT_LAYER_TAP<<12|OP_ON_OFF,LAYER_OFF_ON:ACT_LAYER_TAP<<12|OP_OFF_ON,LAYER_SET_CLEAR:ACT_LAYER_TAP<<12|OP_SET_CLEAR,LAYER_BIT_AND:ACT_LAYER<<12|OP_BIT_AND<<10,LAYER_BIT_OR:ACT_LAYER<<12|OP_BIT_OR<<10,LAYER_BIT_XOR:ACT_LAYER<<12|OP_BIT_XOR<<10,LAYER_BIT_SET:ACT_LAYER<<12|OP_BIT_SET<<10,DEFAULT_LAYER_SET:ACT_LAYER<<12|OP_BIT_SET<<10|ON_SPECIAL_USE<<8,UNKNOWN:0};function Action(e){this.code=e,Object.defineProperty(this,"kind",{set:function(e){this.code|=(15&e)<<12},get:function(){return(61440&this.code)>>12}}),Object.defineProperty(this,"key_mods",{set:function(e){this.code|=(31&e)<<8},get:function(){return(7936&this.code)>>8}}),Object.defineProperty(this,"key_code",{set:function(e){this.code|=255&e},get:function(){return 255&this.code}}),Object.defineProperty(this,"usage_page",{set:function(e){this.code|=(3&e)<<10},get:function(){return(3072&this.code)>>10}}),Object.defineProperty(this,"usage_code",{set:function(e){this.code|=1023&e},get:function(){return 1023&this.code}}),Object.defineProperty(this,"layer_tap_val",{set:function(e){this.code|=(31&e)<<8},get:function(){return(7936&this.code)>>8}}),Object.defineProperty(this,"layer_tap_code",{set:function(e){this.code|=255&e},get:function(){return 255&this.code}}),Object.defineProperty(this,"layer_bitop_op",{set:function(e){this.code|=(3&e)<<10},get:function(){return(3072&this.code)>>10}}),Object.defineProperty(this,"layer_bitop_on",{set:function(e){this.code|=(3&e)<<8},get:function(){return(768&this.code)>>8}}),Object.defineProperty(this,"layer_bitop_part",{set:function(e){this.code|=(7&e)<<5},get:function(){return(224&this.code)>>5}}),Object.defineProperty(this,"layer_bitop_xbit",{set:function(e){this.code|=(1&e)<<4},get:function(){return(16&this.code)>>4}}),Object.defineProperty(this,"layer_bitop_bits",{set:function(e){this.code|=15&e},get:function(){return 15&this.code}}),Object.defineProperty(this,"mousekey_code",{set:function(e){this.code|=255&e},get:function(){return 255&this.code}}),Object.defineProperty(this,"am_code",{set:function(e){this.code|=15&e},get:function(){return 4095&this.code}}),Object.defineProperty(this,"af_code",{set:function(e){this.code|=15&e},get:function(){return 4095&this.code}});function r(e){var a="",t=[];return 1&e&&(a+="⌃",t.push("Control")),2&e&&(a+="⇧",t.push("Shift")),4&e&&(a+="⌥",t.push("Alt")),8&e&&(a+="⌘",t.push("Gui")),t=t.join(" + "),1==a.length?(a=mods_codes[e].name,16&e&&(t="Right "+t)):16&e&&(a="r"+a,t="Right "+t),{name:a,desc:t}}this.get_action=function(){switch((61440&this.code)>>12){case ACT_LMODS:case ACT_RMODS:if(0==this.key_mods){if(keycodes[this.key_code])return $.extend({},action_kinds.KEY,{name_dsa:keycodes[this.key_code].name_dsa,name:keycodes[this.key_code].name,desc:keycodes[this.key_code].desc})}else{if(extra_keycodes[this.code])return $.extend({},action_kinds.KEY,{name_dsa:extra_keycodes[this.code].name_dsa,name:extra_keycodes[this.code].name,desc:extra_keycodes[this.code].desc});var e,a,t;if(keycodes[this.key_code])return s=r(this.key_mods),t=2==this.key_mods&&kc_symbol(this.key_code)?(e='<i class="midfont">'+keycodes[this.key_code].name.substring(0,1)+"</i>",a='<i class="midfont">'+keycodes[this.key_code].name.substring(0,1)+"</i>","直接输出标点 <kt>{0}</kt>, 等效于 <kt>{1}</kt> + <kt>{2}</kt>".format(keycodes[this.key_code].name.substring(0,1),s.desc,keycodes[this.key_code].desc)):(e=s.name+"+<br>"+keycodes[this.key_code].name_dsa,keycodes[this.key_code].name_dsa&&(e=s.name+"+<br>"+keycodes[this.key_code].name_dsa.replace("<br>"," ")),a=s.name+"+<br>"+keycodes[this.key_code].name.replace("<br>"," "),"<kt>{0}</kt> + <kt>{1}</kt>".format(s.desc,keycodes[this.key_code].desc)),$.extend({},action_kinds.MODS_KEY,{name_dsa:e,name:a,desc:t})}break;case ACT_LMODS_TAP:case ACT_RMODS_TAP:var s=r(this.key_mods);switch(this.key_code){case MODS_ONESHOT:return $.extend({},action_kinds.MODS_ONESHOT,{name:s.name+" OneShot",desc:s.desc+" OneShot"});case MODS_TAP_TOGGLE:return $.extend({},action_kinds.MODS_TAP_TOGGLE,{name:s.name+" TapToggle",desc:s.desc+" TapToggle"})}if(null==keycodes[this.key_code])break;c=(c=keycodes[this.key_code].name_dsa)&&c.replace("<br>"," ");var o=keycodes[this.key_code].name.replace("<br>"," ");return $.extend({},action_kinds.MODS_TAP_KEY,{name_dsa:s.name+"|<br>"+c,name:s.name+"|<br>"+o,desc:"长按及与其他键组合时：<kt>{0}</kt> ；<br>快速单击时为 <kt>{1}</kt>".format(s.desc,keycodes[this.key_code].desc)});case ACT_LAYER:var n=1==this.layer_bitop_bits||2==this.layer_bitop_bits||4==this.layer_bitop_bits||8==this.layer_bitop_bits;switch(this.layer_bitop_op){case OP_BIT_AND:return action_kinds.LAYER_BIT_AND;case OP_BIT_OR:return action_kinds.LAYER_BIT_OR;case OP_BIT_XOR:if(this.layer_bitop_on==ON_RELEASE&&0==this.layer_bitop_xbit&&n){for(var d=4*this.layer_bitop_part,i=this.layer_bitop_bits;i>>1;i>>=1)d++;return $.extend({},action_kinds.LAYER_TOGGLE,{name:"T"+d,desc:"点击打开或关闭 层<kt>{0}</kt>".format(d)})}return action_kinds.LAYER_BIT_XOR;case OP_BIT_SET:if(this.layer_bitop_on==ON_SPECIAL_USE&&0==this.layer_bitop_xbit&&n){for(d=4*this.layer_bitop_part,i=this.layer_bitop_bits;i>>1;i>>=1)d++;return $.extend({},action_kinds.DEFAULT_LAYER_SET,{name:"默认 层"+d,desc:"设置默认层 层"+d})}if(this.layer_bitop_on==ON_PRESS&&0==this.layer_bitop_xbit&&n){for(d=4*this.layer_bitop_part,i=this.layer_bitop_bits;i>>1;i>>=1)d++;return $.extend({},action_kinds.UNKNOWN,{name:"T->"+d,desc:"跳转到 层<kt>{0}</kt>".format(d)})}return action_kinds.UNKNOWN}break;case ACT_LAYER_EXT:break;case ACT_LAYER_TAP:case ACT_LAYER_TAP_EXT:switch(this.layer_tap_code){case OP_TAP_TOGGLE:return $.extend({},action_kinds.LAYER_TAP_TOGGLE,{name:"LT"+this.layer_tap_val,desc:"Switch Layer "+this.layer_tap_val+" with Tap toggle"});case OP_ON_OFF:o="L"+this.layer_tap_val;return 1==this.layer_tap_val&&(o="Fn/"+o),$.extend({},action_kinds.LAYER_MOMENTARY,{name:o,desc:"瞬时开启（按下开启，松开关闭） 层<kt>{0}</kt>".format(this.layer_tap_val)});case OP_OFF_ON:return action_kinds.LAYER_OFF_ON;case OP_SET_CLEAR:return action_kinds.LAYER_SET_CLEAR;default:if(224==(240&this.layer_tap_code))return s=r(15&this.layer_tap_code),$.extend({},action_kinds.LAYER_MODS,{name:"LM"+this.layer_tap_val+"<br>"+s.name,desc:"瞬时开启 层<kt>{0}</kt>, 同时按住 <kt>{1}</kt>".format(this.layer_tap_val,s.desc)});if(null==keycodes[this.key_code])break;layer_tap_s=this.layer_tap_val<8?this.layer_tap_val:this.layer_tap_val-8+"(S)";c=(c=keycodes[this.key_code].name_dsa)&&c.replace("<br>"," ");var c,o=keycodes[this.key_code].name.replace("<br>"," ");return $.extend({},action_kinds.LAYER_TAP_KEY,{name_dsa:"LT"+layer_tap_s+"<br>"+c,name:"LT"+layer_tap_s+"<br>"+o,desc:"长按及与其他键组合时，瞬时开启 层<kt>{0}</kt> ；<br>快速单击时为 <kt>{1}</kt>".format(layer_tap_s,keycodes[this.layer_tap_code].desc)})}break;case ACT_USAGE:switch(this.usage_page){case PAGE_SYSTEM:if(system_codes[this.usage_code])return $.extend({},action_kinds.USAGE_SYSTEM,{name:system_codes[this.usage_code].name,desc:system_codes[this.usage_code].desc});case PAGE_CONSUMER:if(consumer_codes[this.usage_code])return $.extend({},action_kinds.USAGE_CONSUMER,{name:consumer_codes[this.usage_code].name,desc:consumer_codes[this.usage_code].desc})}break;case ACT_MOUSEKEY:if(mousekey_codes[this.mousekey_code])return $.extend({},action_kinds.MOUSEKEY,{name:mousekey_codes[this.mousekey_code].name,desc:mousekey_codes[this.mousekey_code].desc});break;case ACT_MACRO:if(am_codes[this.am_code])return $.extend({},action_kinds.MACRO,{name:am_codes[this.af_code].name,desc:am_codes[this.af_code].desc});break;case ACT_FUNCTION:if(af_codes[this.af_code])return $.extend({},action_kinds.FUNCTION,{name:af_codes[this.af_code].name,desc:af_codes[this.af_code].desc})}return action_kinds.UNKNOWN},Object.defineProperty(this,"id",{get:function(){return this.get_action().id}}),Object.defineProperty(this,"name",{get:function(){var e=this.get_action();return null!=e?e.name:""}}),Object.defineProperty(this,"name_dsa",{get:function(){var e=this.get_action();if(null!=e)return e.name_dsa}}),Object.defineProperty(this,"desc",{get:function(){var e=this.get_action();return null!=e?e.desc:""}})}function action_editor_get_code(){var e=$("#kind_dropdown-btn").attr("value"),a=parseInt($("#keycodes_dropdown-btn").attr("value")),t=parseInt($("#keycodes4tap_dropdown-btn").attr("value")),s=parseInt($("#key_mods_dropdown-btn").attr("value")),o=parseInt($("#layer_dropdown-btn").attr("value")),n=parseInt($("#layer_tap_dropdown-btn").attr("value")),d=parseInt($("#layer_mods_dropdown-btn").attr("value")),i=parseInt($("#layer_on_dropdown-btn").attr("value")),c=parseInt($("#launch_shortcut_dropdown-btn").attr("value"));switch(e){case"KEY":return kind_codes[e]|a;case"MODS_KEY":return kind_codes[e]|s<<8|a;case"MODS_TAP_KEY":return kind_codes[e]|s<<8|t;case"MODS_ONESHOT":case"MODS_TAP_TOGGLE":return kind_codes[e]|s<<8;case"USAGE_SYSTEM":return kind_codes[e]|system_code;case"USAGE_CONSUMER":return kind_codes[e]|consumer_code;case"MOUSEKEY":return kind_codes[e]|mousekey_code;case"LAYER_MOMENTARY":case"LAYER_ON_OFF":case"LAYER_OFF_ON":case"LAYER_SET_CLEAR":case"LAYER_TAP_TOGGLE":return kind_codes[e]|o<<8;case"LAYER_TAP_KEY":return kind_codes[e]|n<<8|t;case"LAYER_MODS":return kind_codes[e]|o<<8|d;case"LAYER_INVERT":case"LAYER_ON":case"LAYER_OFF":case"LAYER_SET":return kind_codes[e]|i<<8|o/4<<5|1<<o%4;case"LAYER_TOGGLE":return kind_codes[e]|o/4<<5|1<<o%4;case"LAYER_CLEAR":return kind_codes[e]|i<<8|0;case"DEFAULT_LAYER_SET":return 0|kind_codes[e]|o/4<<5|1<<o%4;case"LAUNCH_SHORTCUT":return c}return 0}function update_copyright(){var e=(new Date).getFullYear()-2016,a=0,t=setInterval(function(){++a>=e&&clearInterval(t),$("#tyear").text(2016+a)},1e3)}async function fetchHeader(e,a){const t=await fetch(e);return t.headers.get(a)}function format_date(e){dateDigitToString=function(e){return e<10?"0"+e:e};var a=dateDigitToString(e.getFullYear()),t=dateDigitToString(e.getMonth()+1),s=dateDigitToString(e.getDate()),e=a+"-"+t+"-"+s+" "+dateDigitToString(e.getHours())+":"+dateDigitToString(e.getMinutes())+":"+dateDigitToString(e.getSeconds());return last_modified_date_short=shorten_date(a%100)+shorten_date(t)+shorten_date(s),console.log("Latest firmware: "+last_modified_date_short+" "+e),{short:last_modified_date_short,long:e}}function checkResponse(e){var a;if(200<=e.status&&e.status<300)return e;throw(a=new Error(e.statusText)).response=e,a}function parseTEXT(e){return e.text()}function parseJSON(e){return e.json()}$(function(){$("#kind_dropdown").change(function(e){let t="";t+="kind";var s=$("#kind_dropdown-btn").attr("value");switch(s){case"KEY":t+=" keycodes";break;case"MODS_KEY":t+=" keycodes",t+=" key_mods";break;case"MODS_TAP_KEY":t+=" keycodes4tap",t+=" key_mods";break;case"MODS_ONESHOT":case"MODS_TAP_TOGGLE":t+=" key_mods";break;case"LAYER_MOMENTARY":case"LAYER_ON_OFF":case"LAYER_OFF_ON":case"LAYER_SET_CLEAR":case"LAYER_TAP_TOGGLE":t+=" layer";break;case"LAYER_TAP_KEY":t+=" keycodes4tap",t+=" layer_tap";break;case"LAYER_MODS":t+=" layer",t+=" layer_mods";break;case"LAYER_INVERT":case"LAYER_ON":case"LAYER_OFF":case"LAYER_SET":t+=" layer",t+=" layer_on";break;case"LAYER_TOGGLE":t+=" layer";break;case"LAYER_CLEAR":t+=" layer_on";break;case"DEFAULT_LAYER_SET":t+=" layer";break;case"LAUNCH_SHORTCUT":t+=" launch_shortcut"}$("#fn-set").find("[id$=_dropdown-btn]").each(function(){var e,a=this.id.slice(0,-13);t.split(" ").includes(a)?$(this).addClass("showf").removeClass("hidef hidden"):"block"==$(this).css("display")&&($(this).addClass("hidef").removeClass("showf"),e=$(this),setTimeout(function(){e.addClass("hidden")},300)),"LAYER_MODS"==s&&$("#layer_mods_dropdown").find("li").each(function(){15<=$(this).attr("value")?$(this).hide():$(this).show()}),$("#keycodes_dropdown").find("li").each(function(){224<=$(this).attr("value")&&("MODS_KEY"==s?$(this).hide():$(this).show())})})})}),$(function(){$("#display-layout-info").click(function(){var o,n;0==$("#keyboard-outline").find(".keycap-length").length?(n=o=0,$("#keyboard-outline").find(".key:visible").each(function(){var t,e=$(this).parents().parents().parents().attr("class"),a=e.match(/.*? w(\d+).*?/),s=e.match(/.*? h(\d+).*?/);e.match(/.*?round|square.*?/)||(o++,e=0,1.5==(a=a?a[1]/100:s?s[1]/100:1)&&s&&200==s[1]&&(a+="/2",e=2),$(this).attr("length",a+"u"),2<=a&&a<=2.75?e=2:3<=a&&(e=a),0<e&&(s=e+("zh_sc"==language?"u 卫星轴":"u stabilizer"),$(this).attr("stabilizer",s)),t=$(this),setTimeout(function(){t.attr("length")&&t.removeClass("fade-in-down fade-in-up").addClass("fade-out-down")},15*o),setTimeout(function(){n++;var e=t.attr("length"),a=("<br>"+t.attr("stabilizer")).replace(/<br>undefined/,"");e&&(t.removeClass("fade-out-down").addClass("fade-in-down"),t.html('<span class="keycap-length">{0}</span>{1}'.format(e,a)),t.removeAttr("length stabilizer")),$("#this_layout_keys").text(n),n==o&&setTimeout(function(){$("#keyboard-outline").find(".homing").find(".key").removeClass("fade-in-down fade-in-up")},15)},15*o+200))}),$("#layout-info-pane").css("display","").removeClass("hidef").addClass("showf")):$("#layer_set").tabs("select","layer_0")})}),String.prototype.format=function(){var e,a=this;for(e in arguments)var t=new RegExp("\\{"+e+"\\}","gi"),a=a.replace(t,arguments[e]);return a};var $jsonp=function(){var e={send:function(e,a){var t=a.callbackName||"callback",s=a.onSuccess||function(){},o=a.onTimeout||function(){},a=a.timeout||10,n=window.setTimeout(function(){window[t]=function(){},o()},1e3*a),a=(window[t]=function(e){window.clearTimeout(n),s(e)},document.createElement("script"));a.type="text/javascript",a.async=!0,a.src=e,document.getElementsByTagName("head")[0].appendChild(a),a.parentNode.removeChild(a)}};return e}();function fadeToggle(e,a){var t,s,a=a||16.6;0==e.style.opacity?(e.style.display="block",t=0,s=setInterval(function(){t++,e.style.opacity=t/20,20<=t&&clearInterval(s)},a)):1==e.style.opacity&&(t=20,s=setInterval(function(){t--,e.style.opacity=t/20,0==t&&(e.style.display="none",clearInterval(s))},a))}function update_share_url_panel(){var e;$("#share-dialog").hasClass("url-long")?(e=parseInt($("#share-dialog")[0].style.getPropertyValue("--aug-r")))<80&&(e++,$("#share-dialog")[0].style.setProperty("--aug-r",e+"px"),setTimeout("update_share_url_panel()",10)):12<(e=60<(e=parseInt($("#share-dialog")[0].style.getPropertyValue("--aug-r")))?60:e)&&(e--,$("#share-dialog")[0].style.setProperty("--aug-r",e+"px"),setTimeout("update_share_url_panel()",10))}