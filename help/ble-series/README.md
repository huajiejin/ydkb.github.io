# BLE双模使用

YDKB BLE系列的键盘与市面上的大部分量产的双模或蓝牙键盘，在蓝牙的配对，设备的切换上，都有较明显的区别，不能单凭之前的经验来使用本系列的产品。

这个方案是从2018年1月开始使用的，首款键盘为YD60BLE。

BLE系列泛指YDKB支持的，集成nrf51蓝牙模块的键盘。

蓝牙固件使用的是Adafruit的，参考资料：<br>
https://learn.adafruit.com/introducing-the-adafruit-bluefruit-le-uart-friend/introduction

> [!ydda] 重要建议：
>  - 焊接版的PCB或套件，即使你不喜欢或不需要灯，至少请把Caps指示灯装上。
>  - 在这些键盘上，Caps指示灯还会用于指示蓝牙的各种状态、电池低电量、刷机状态等等。



## 背景故事
这一些还是在1800mini的时候写下的，也是BLE系列开始时的想法，记录下来，有兴趣的可以看看。

现今的不少双模或蓝牙机械键盘不够好用，我简单总结一下主要是几个原因。
  1. 蓝牙连接不稳定。
  2. 键盘从节能到唤醒速度太慢。甚至不少键盘在键盘节能后，按的第一个键可能还根本不会输出。
  3. 续航能力太弱。
  4. 不支持按键编程。

所以主要也是针对这几点去改善，第一点不稳定有很多其实是固件与模块本身的原因，但是量产的键盘，其中很多都是买的成品方案，也不能指望再改进什么了。所以，
  1. 针对1，使用蓝牙模块为进口优质产品，并且蓝牙固件也不是我这种半调子水平写出来的，同时使用蓝牙模块也不用自己再去考虑天线的问题。而事实证明这款模块的天线设计效果非常的OK。
  2. 针对2，不考虑那么极致的省电，就BLE40使用1500mah的电池来看，不开灯的情况下，每天使用15小时+，使用1到2个月没问题。虽然达不到有些键盘电池用半年那种续航，但是也够满足了。同时还提供了临时关闭节能的功能，这样可以让键盘处于荧光棒模式（键盘灯一直亮）。
  3. 针对3，这里有从硬件上的优化，硬件上尽量的去减少耗电，即使都是BLE的蓝牙模块，在做为HID工作时，它们的耗电都可以差到10倍以上。目前这个模块在蓝牙工作时，它本身耗电只有1.xma。可能还有不少人记得BLE60，那个使用的CSR1010的模块，实测其本身工作时耗电在10ma以上。然后就是配合合适的节能设置了，平衡使用体验与续航。
  4. 针对4，BLE系列支持全键编程，共8层可以设置。
