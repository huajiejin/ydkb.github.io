# 瀚文75 (HW75) 
## 开源地址

UF2 bootloader： https://github.com/yangdigi/uf2-stm32f103

TMK firmware: https://github.com/yangdigi/tmk_keyboard/tree/master/keyboard/hw75

## 触摸条操作

以下说明基于 2023-01-06 DN16 固件。

触摸条一共是6个感应点。目前一共支持四个动作，左右滑动比较特殊一点，所以单独讲一下。

可以自定义向左和向右滑动，对应到执行两个按键功能。具体操作逻辑是
1. 从闲置状态开始，在触摸条任意位置开始向左或向右滑动一半距离以上，触发按键。
2. 触发按键后，如果手不放开，则保持此按键长按。
3. 触发后手放开，只要未超时500ms，连续点击中间四个点，就可以再次触发按键。
4. 如果超过500ms未有任何点击动作，则超时。回到闲置状态，重新从第1步开始识别。
5. 另外，如果在500ms内，从最边上点滑动 (也可以从触摸条最外面滑进来)，则直接重新触发新的左右滑动操作。

这么设计的目的有两个。
1. 可以实现精准次数的操作。比如左滑设置为方向左，想精准的左移动 10 次。那么左滑一次，然后再连续点击触摸条中间位置 9 次。一共就移动 10 次。
2. 通过操作过程中从边缘重新滑动，熟练后，可以实现更惬意的连点时，反方向滑动也无等待切换。

## 固件更新

固件需要更新为 YDKB UF2 bootloader 或者 瀚文的 HID-BL v2.1 才能正常使用。

HW75 B站发货版本默认都是 HID-BL v2.1 了。

刷新固件的方法在 ydkb.io 的对应键盘页面有写，这里不再重复。


##  YDKB UF2-BL 和 HID-BL v2.1 互换的简单方法

> [!ydda] 注意
> - 首先确认你已经在正常使用 ydkb.io 的固件了，以及你会刷新固件。
> - 然后就非常简单了。

UF2-BL 特点：使用 UF2-BL，更新固件时不需要借助更新器，且支持 macOS 等其他一些系统。

这是需要的固件： [hw75_uf2_hid_bl.zip](keyboards/assets/hw75_uf2_hid_bl.zip ':ignore')

```
hw75_uf2-bl_2.3.2_hid-bl_2.1.uf2
hw75_uf2-bl_2.3.2_hid-bl_2.1.bin
```

这两个文件，它们是相同的固件，只是不同的格式。

根据你当前使用的BL，刷入这个固件。比如你当前是bin刷的，就刷入 `hw75_uf2-bl_2.3.2_hid-bl_2.1.bin`。

刷好后，灯光会恢复到全灯一起变色。这是一个专门用来互换BL的固件，它的USB设备名称如下：

![|600](assets/hw75-upbl-fw-name.png)

在这个固件下，直接同时按下键盘的 <kbd>LShift+RShift+LCtrl+U</kbd> 四个按键，就会切换当前的BL了。

切换后键盘会自动重启。
1. 若重启后直接进了UF2的刷机模式(显示U盘，右上角轴灯闪黄灯)，则更新到了v2.3.2的UF2-BL。
2. 若重启后还是键盘功能，可以手动(按Fn不放插线)再进刷机模式确认已经恢复到 HID-BL v2.1。
3. 关于第1点的补充，v2.0.5和v2.3.1版本的UF2-BL，运行第一次会先升级到v2.3.2的UF2-BL。

更换BL后，请自行再重新刷新一个从 ydkb.io 下载的最新固件。

> [!yddh] 提醒
> - 这个方法很简单。适合于UF2-BL的升级，以及与HID-BL之间的互换。


## 最后一些资料存档

最早提供的是 UF2-BL 是 v2.0.5 的，最新更新到 v2.3.2 的变化如下

1.  v2.3.1 增加了刷机模式下，右上角轴灯闪烁黄灯。
2.  v2.3.1 进入刷机模式后，如果不需要刷新，可以再按一次 Fn 退出刷机模式。
3.  v2.3.2 修复在使用 LShift+RShift+LCtrl+B 进入刷机模式时不闪黄灯的问题

> [!yddh] 查看当前 UF2-BL 版本的方法
> - 键盘进入刷机模式后，里面有一个 INFO_UF2.TXT 文件。打开看，第一行就是当前 BL 版本。

这是单独的 UF2-BL 文件，也可用 ST-LINK 等方式刷入后直接使用： [ydkb_uf2boot_hw75_v232.bin](keyboards/assets/ydkb_uf2boot_hw75_v232.bin ':ignore')

